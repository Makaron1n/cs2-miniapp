<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>CS2 Mini App - –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–æ–≤</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        :root {
            /* Standard Theme (Default) */
            --bg-primary: #0f1923;
            --bg-secondary: #1c2733;
            --bg-tertiary: #243447;
            --text-primary: #fff;
            --text-secondary: #8899a6;
            --accent-primary: #4facfe;
            --accent-secondary: #00f2fe;
            --border-color: #2d3e50;
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        /* Light Theme */
        [data-theme="light"] {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8ecf1;
            --text-primary: #1a1a2e;
            --text-secondary: #4a5568;
            --accent-primary: #3b82f6;
            --accent-secondary: #06b6d4;
            --border-color: #d1d5db;
        }
        
        /* Dark Theme */
        [data-theme="dark"] {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --text-primary: #e4e4e7;
            --text-secondary: #71717a;
            --accent-primary: #8b5cf6;
            --accent-secondary: #a855f7;
            --border-color: #27272a;
        }
        
        /* Font Families */
        [data-font="standard"] { --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        [data-font="pixel"] { --font-family: 'Press Start 2P', cursive; }
        
        * { box-sizing: border-box; }
        
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: var(--font-family);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            transition: background 0.3s ease, color 0.3s ease;
        }
        
        /* Pixel font size adjustments */
        [data-font="pixel"] .menu-item { font-size: 8px; }
        [data-font="pixel"] .btn { font-size: 10px; }
        [data-font="pixel"] .card-title { font-size: 12px; }
        [data-font="pixel"] .settings-item-info h4 { font-size: 11px; }
        [data-font="pixel"] .settings-item-info p { font-size: 9px; }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 10px;
            padding-bottom: 80px;
        }
        
        /* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
        .menu {
            display: flex;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            z-index: 100;
            transition: background 0.3s ease, border-color 0.3s ease;
        }
        
        .menu-item {
            flex: 1;
            text-align: center;
            padding: 12px 5px;
            font-size: 11px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .menu-item:hover { color: #fff; }
        .menu-item:active { transform: scale(0.95); }
        
        .menu-item.active {
            color: #4facfe;
        }
        
        .menu-item.active::before {
            width: 100%;
        }
        
        .menu-icon { font-size: 20px; display: block; margin-bottom: 3px; }
        
        /* ===== –ö–ù–û–ü–ö–ò –° –ê–ù–ò–ú–ê–¶–ò–ï–ô ===== */
        .btn {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border: none;
            color: #000;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(79, 172, 254, 0.4);
        }
        
        .btn:active {
            transform: translateY(0) scale(0.98);
        }
        
        .btn:active::after {
            width: 300px;
            height: 300px;
        }
        
        .btn-danger {
            background: linear-gradient(90deg, #ff6b6b, #ee5a5a);
        }
        
        .btn-danger:hover {
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(90deg, #00b894, #00cec9);
        }
        
        .btn-success:hover {
            box-shadow: 0 5px 20px rgba(0, 184, 148, 0.4);
        }
        
        .btn-steam {
            background: linear-gradient(90deg, #1b2838, #2a475e);
            color: #fff;
        }
        
        .btn-steam:hover {
            box-shadow: 0 5px 20px rgba(27, 40, 56, 0.6);
        }
        
        /* ===== –≠–ö–†–ê–ù–´ ===== */
        .screen { display: none; }
        .screen.active { display: block; animation: fadeIn 0.3s ease; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== –ö–ê–†–¢–û–ß–ö–ò ===== */
        .card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: background 0.3s ease;
        }
        
        .card-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* ===== –ü–†–û–§–ò–õ–¨ ===== */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }
        
        .profile-info h2 { margin: 0 0 5px 0; font-size: 20px; }
        .profile-info .sub { color: #8899a6; font-size: 13px; }
        
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            text-align: center;
        }
        
        .quick-stat {
            background: #243447;
            padding: 12px 8px;
            border-radius: 10px;
        }
        
        .quick-stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #4facfe;
        }
        
        .quick-stat-label {
            font-size: 11px;
            color: #8899a6;
            margin-top: 3px;
        }
        
        /* ===== CS2 –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===== */
        .cs2-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .cs2-stat {
            background: #243447;
            padding: 12px;
            border-radius: 8px;
        }
        
        .cs2-stat-label { font-size: 11px; color: #8899a6; }
        .cs2-stat-value { font-size: 16px; font-weight: bold; margin-top: 3px; }
        
        /* ===== –ö–í–ï–°–¢–´ ===== */
        .quests-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .daily-limit {
            background: #243447;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
        }
        
        .daily-limit-value {
            color: #4facfe;
            font-weight: bold;
        }
        
        .quest-item {
            background: #243447;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .quest-info {
            flex: 1;
        }
        
        .quest-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .quest-description {
            font-size: 11px;
            color: #8899a6;
            margin-bottom: 8px;
        }
        
        .quest-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .quest-progress-bar {
            flex: 1;
            height: 6px;
            background: #1c2733;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .quest-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .quest-progress-text {
            font-size: 11px;
            color: #8899a6;
            min-width: 50px;
        }
        
        .quest-reward {
            text-align: center;
            padding-left: 15px;
        }
        
        .quest-reward-value {
            font-size: 16px;
            font-weight: bold;
            color: #f7b733;
        }
        
        .quest-reward-label {
            font-size: 10px;
            color: #8899a6;
        }
        
        .quest-btn {
            margin-top: 8px;
            padding: 6px 12px;
            font-size: 11px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .quest-btn-claim {
            background: linear-gradient(90deg, #00b894, #00cec9);
            color: #fff;
        }
        
        .quest-btn-claim:hover {
            transform: scale(1.05);
        }
        
        .quest-btn-disabled {
            background: #2d3e50;
            color: #8899a6;
            cursor: not-allowed;
        }
        
        .quest-completed {
            opacity: 0.6;
        }
        
        .quest-completed .quest-progress-fill {
            background: #00b894;
        }
        
        /* ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–´–ë–û–†–ê –ö–ê–ß–ï–°–¢–í–ê ===== */
        .wear-selector-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .wear-selector-modal.active {
            opacity: 1;
        }
        
        .wear-selector-content {
            background: #1c2733;
            border-radius: 15px;
            padding: 20px;
            max-width: 350px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        
        .wear-selector-modal.active .wear-selector-content {
            transform: scale(1);
        }
        
        .wear-selector-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: bold;
        }
        
        .wear-selector-skin {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .wear-selector-skin img {
            width: 120px;
            height: 90px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        
        .wear-selector-skin div {
            font-size: 13px;
            color: #ccc;
        }
        
        .wear-selector-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .wear-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: #243447;
            border: none;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .wear-option:hover {
            background: #2d4a63;
            transform: translateX(5px);
        }
        
        .wear-short {
            background: #4facfe;
            color: #fff;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 11px;
            min-width: 30px;
            text-align: center;
        }
        
        /* –ë–µ–π–¥–∂ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ */
        .wear-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 2px 5px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: bold;
            z-index: 5;
        }
        .wear-badge.fn { background: #27ae60; }
        .wear-badge.mw { background: #2ecc71; }
        .wear-badge.ft { background: #f39c12; }
        .wear-badge.ww { background: #e67e22; }
        .wear-badge.bs { background: #e74c3c; }
        
        .wear-full {
            font-size: 14px;
        }

        /* ===== –ò–ù–í–ï–ù–¢–ê–†–¨ ===== */
        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 10px;
        }
        
        .inv-item {
            background: #243447;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .inv-item:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .inv-item img {
            width: 70px;
            height: 70px;
            object-fit: contain;
        }
        
        .inv-item-name {
            font-size: 9px;
            margin-top: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .inv-item-price {
            font-size: 10px;
            color: #f7b733;
            font-weight: bold;
            margin-top: 3px;
        }
        
        .inv-item-checkbox {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #4facfe;
        }
        
        .inv-item.selected {
            background: #2d4a5e;
            box-shadow: 0 0 0 2px #4facfe;
        }
        
        .inv-item-buttons {
            display: flex;
            gap: 4px;
            margin-top: 5px;
        }
        
        .inv-btn {
            flex: 1;
            padding: 4px 2px;
            font-size: 8px;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .inv-btn-sell {
            background: linear-gradient(90deg, #00b894, #00cec9);
        }
        
        .inv-btn-withdraw {
            background: linear-gradient(90deg, #1b2838, #2a475e);
        }
        
        .inv-btn:hover {
            transform: scale(1.05);
        }
        
        .inv-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å–∫–∏–Ω–∞ */
        .inv-item-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(0,0,0,0.3);
            border-radius: 0 0 8px 8px;
            overflow: hidden;
        }
        
        .inv-item-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #00b894, #00cec9);
            transition: width 0.1s linear;
        }
        
        .inv-item.selling {
            opacity: 0.7;
            pointer-events: none;
        }
        
        .inv-item.selling .inv-item-progress-bar {
            animation: progressAnim 0.6s ease-out forwards;
        }
        
        @keyframes progressAnim {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        .inv-item.sold {
            animation: soldAnim 0.3s ease forwards;
        }
        
        @keyframes soldAnim {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); background: rgba(0, 184, 148, 0.3); }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .inventory-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .select-all-label {
            font-size: 11px;
            color: #8899a6;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }
        
        .select-all-label input {
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: #4facfe;
        }
        
        .selected-count {
            font-size: 11px;
            color: #4facfe;
            margin-left: 5px;
        }
        /* ===== –ö–ï–ô–°–´ ===== */
        .balance-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #1c2733;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
        }
        
        .balance { font-size: 22px; font-weight: bold; }
        .balance span { color: #4facfe; }
        
        .cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .case-card {
            background: #1c2733;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .case-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.2);
            border-color: #4facfe;
        }
        
        .case-card:active { transform: translateY(-2px) scale(0.98); }
        
        .case-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .case-card.disabled:hover {
            transform: none;
            box-shadow: none;
            border-color: transparent;
        }
        
        .case-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }
        
        .case-name { font-size: 18px; font-weight: bold; }
        .case-price { 
            color: #4facfe; 
            font-size: 16px; 
            font-weight: bold;
            background: rgba(79, 172, 254, 0.1);
            padding: 5px 10px;
            border-radius: 8px;
        }
        
        .case-desc { font-size: 12px; opacity: 0.7; margin-bottom: 15px; }
        
        /* ===== –ü–£–õ –°–ö–ò–ù–û–í –ö–ï–ô–°–ê ===== */
        .case-skins-pool {
            background: #0f1923;
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
        }
        
        .case-skins-title {
            font-size: 11px;
            color: #8899a6;
            margin-bottom: 8px;
        }
        
        .case-skins-preview {
            display: flex;
            gap: 5px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .case-skins-preview::-webkit-scrollbar {
            height: 4px;
        }
        
        .case-skins-preview::-webkit-scrollbar-thumb {
            background: #4facfe;
            border-radius: 2px;
        }
        
        .case-skin-item {
            flex-shrink: 0;
            width: 60px;
            text-align: center;
        }
        
        .case-skin-item img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            border-radius: 4px;
            background: #1c2733;
        }
        
        .case-skin-item-name {
            font-size: 8px;
            color: #8899a6;
            margin-top: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* ===== –ö–ù–û–ü–ö–ò –ö–ï–ô–°–ê ===== */
        .case-info {
            font-size: 13px;
            color: #8899a6;
            margin: 10px 0;
        }
        
        .case-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .case-buttons .btn {
            flex: 1;
            padding: 10px;
            font-size: 13px;
        }
        
        .btn-secondary {
            background: linear-gradient(90deg, #2d3e50, #3d5a73);
            color: #fff;
        }
        
        .btn-secondary:hover {
            box-shadow: 0 5px 20px rgba(45, 62, 80, 0.4);
        }
        
        /* ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ï–ô–°–ê ===== */
        .case-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 200;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        
        .case-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            max-width: 600px;
            margin: 0 auto;
            background: #1c2733;
            border-radius: 16px;
            padding: 20px;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #243447;
            border: none;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: #ff6b6b;
            transform: rotate(90deg);
        }
        
        .modal-rarity-section {
            margin-bottom: 20px;
        }
        
        .modal-rarity-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #2d3e50;
        }
        
        .modal-skins-row {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
        }
        
        .modal-skin-item {
            background: #243447;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            border: 2px solid;
            transition: all 0.2s ease;
        }
        
        .modal-skin-item:hover {
            transform: scale(1.05);
        }
        
        .modal-skin-item img {
            width: 60px;
            height: 60px;
            object-fit: contain;
        }
        
        .modal-skin-name {
            font-size: 9px;
            margin-top: 5px;
            color: #ccc;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* ===== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===== */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0f1923;
            z-index: 300;
            display: none;
            overflow-y: auto;
            padding: 15px;
            padding-bottom: 80px;
        }
        
        .admin-panel.active { display: block; }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #2d3e50;
        }
        
        .admin-title {
            font-size: 20px;
            font-weight: bold;
            color: #ff6b6b;
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .admin-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: #1c2733;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .admin-tab.active {
            background: linear-gradient(90deg, #ff6b6b, #ee5a5a);
            color: #fff;
        }
        
        .admin-case-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .admin-case-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #1c2733;
            padding: 15px;
            border-radius: 10px;
        }
        
        .admin-case-info h4 { margin: 0 0 5px 0; }
        .admin-case-info p { margin: 0; font-size: 12px; color: #8899a6; }
        
        .admin-case-actions {
            display: flex;
            gap: 8px;
        }
        
        .admin-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        
        .admin-btn-edit { background: #4facfe; color: #000; }
        .admin-btn-delete { background: #ff6b6b; color: #fff; }
        
        .admin-form {
            background: #1c2733;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .admin-form h3 { margin: 0 0 15px 0; }
        
        .admin-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #2d3e50;
            border-radius: 8px;
            background: #243447;
            color: #fff;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .admin-input:focus {
            outline: none;
            border-color: #4facfe;
        }
        
        .admin-skins-search {
            margin-bottom: 15px;
        }
        
        .admin-skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            background: #0f1923;
            border-radius: 8px;
        }
        
        .admin-skin-item {
            background: #243447;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }
        
        .admin-skin-item:hover {
            border-color: #4facfe;
        }
        
        .admin-skin-item.selected {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.2);
        }
        
        .admin-skin-item img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }
        
        .admin-skin-item-name {
            font-size: 8px;
            margin-top: 3px;
            color: #8899a6;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .admin-selected-skins {
            margin-top: 15px;
        }
        
        .admin-selected-skins h4 {
            margin: 0 0 10px 0;
            font-size: 14px;
        }
        
        .admin-selected-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .admin-selected-item {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #243447;
            padding: 8px;
            border-radius: 6px;
        }
        
        .admin-selected-item img {
            width: 40px;
            height: 40px;
            object-fit: contain;
        }
        
        .admin-selected-item-info { flex: 1; }
        .admin-selected-item-name { font-size: 12px; }
        
        .admin-chance-input {
            width: 60px;
            padding: 5px;
            border: 1px solid #2d3e50;
            border-radius: 4px;
            background: #1c2733;
            color: #fff;
            text-align: center;
        }
        
        .admin-remove-btn {
            background: #ff6b6b;
            border: none;
            color: #fff;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
        }
        
        /* ===== –ö–ê–†–£–°–ï–õ–¨ ===== */
        #carousel-container {
            background: #0a0a12;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            display: none;
        }
        
        #carousel-container.active { display: block; }
        
        /* ===== –¢–û–ü –ò–ì–†–û–ö–û–í ===== */
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #243447;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.2s ease;
        }
        
        .leaderboard-item:hover {
            background: #2d4a5e;
            transform: translateX(5px);
        }
        
        .leaderboard-rank {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        
        .leaderboard-rank.gold { background: linear-gradient(135deg, #f7b733, #fc4a1a); }
        .leaderboard-rank.silver { background: linear-gradient(135deg, #bdc3c7, #2c3e50); }
        .leaderboard-rank.bronze { background: linear-gradient(135deg, #d35400, #e67e22); }
        .leaderboard-rank.default { background: #1c2733; }
        
        .leaderboard-info { flex: 1; }
        .leaderboard-name { font-weight: bold; font-size: 14px; }
        .leaderboard-stats { font-size: 11px; color: #8899a6; }
        .leaderboard-value { font-weight: bold; color: #4facfe; }
        
        /* ===== –ù–ê–°–¢–†–û–ô–ö–ò ===== */
        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            margin-bottom: 10px;
            transition: background 0.3s ease;
        }
        
        .settings-item-info h4 { margin: 0 0 3px 0; font-size: 14px; color: var(--text-primary); }
        .settings-item-info p { margin: 0; font-size: 12px; color: var(--text-secondary); }
        
        /* Settings Options Grid */
        .settings-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .settings-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 15px 10px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .settings-option:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }
        
        .settings-option.active {
            border-color: var(--accent-primary);
            background: rgba(79, 172, 254, 0.1);
        }
        
        .settings-option-icon {
            font-size: 24px;
        }
        
        .settings-option-label {
            font-size: 11px;
            text-align: center;
            color: var(--text-secondary);
        }
        
        .settings-option.active .settings-option-label {
            color: var(--accent-primary);
            font-weight: bold;
        }
        
        /* Theme preview boxes */
        .theme-preview {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }
        
        .theme-preview.standard {
            background: linear-gradient(135deg, #0f1923 50%, #1c2733 50%);
        }
        
        .theme-preview.light {
            background: linear-gradient(135deg, #f5f7fa 50%, #ffffff 50%);
        }
        
        .theme-preview.dark {
            background: linear-gradient(135deg, #0a0a0f 50%, #12121a 50%);
        }
        
        /* Font preview */
        .font-preview {
            font-size: 14px;
            font-weight: bold;
        }
        
        .font-preview.pixel { font-family: 'Press Start 2P', cursive; font-size: 10px; }
        
        .steam-linked {
            color: #00b894;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
        }
        
        /* ===== LOADING ===== */
        .loading-screen {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #4facfe;
        }
        
        .error-screen {
            text-align: center;
            padding: 20px;
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }
        
        /* ===== –û–í–ï–†–õ–ï–ô –ó–ê–ì–†–£–ó–ö–ò ===== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 25, 35, 0.95);
            z-index: 9999;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .loading-overlay.active {
            display: flex;
            animation: fadeIn 0.2s ease;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #243447;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: #fff;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .loading-subtext {
            color: #8899a6;
            font-size: 13px;
        }
        
        .loading-progress {
            width: 200px;
            height: 6px;
            background: #243447;
            border-radius: 3px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .sell-success-icon {
            font-size: 50px;
            margin-bottom: 15px;
            animation: bounceIn 0.5s ease;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        /* –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è */
        .inventory-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #2d3e50;
        }
        
        .pagination-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: #243447;
            border: none;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background: #4facfe;
            transform: scale(1.1);
        }
        
        .pagination-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .pagination-info {
            font-size: 13px;
            color: #8899a6;
        }
        
        .pagination-info span {
            color: #4facfe;
            font-weight: bold;
        }
        
        /* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–µ–π—Å–∞ –≤–æ –≤—Ä–µ–º—è –∫—Ä—É—Ç–∫–∏ */
        .case-card.spinning {
            opacity: 0.5;
            pointer-events: none;
            position: relative;
        }
        
        .case-card.spinning::after {
            content: 'üé∞ –ö—Ä—É—Ç–∏—Ç—Å—è...';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) tg.expand();
    </script>

    <div class="container">
        <!-- ===== –≠–ö–†–ê–ù –ü–†–û–§–ò–õ–Ø ===== -->
        <div id="profile" class="screen active">
            <div class="card">
                <div class="profile-header">
                    <div class="avatar">üë§</div>
                    <div class="profile-info">
                        <h2 id="profileName">Player123</h2>
                        <div class="sub">üéÆ CS2 Mini App</div>
                    </div>
                </div>
                
                <div class="quick-stats">
                    <div class="quick-stat">
                        <div class="quick-stat-value" id="profile-balance">0</div>
                        <div class="quick-stat-label">‚≠ê –ë–∞–ª–∞–Ω—Å</div>
                    </div>
                    <div class="quick-stat">
                        <div class="quick-stat-value" id="profile-cases-opened">0</div>
                        <div class="quick-stat-label">üì¶ –ö–µ–π—Å–æ–≤</div>
                    </div>
                    <div class="quick-stat">
                        <div class="quick-stat-value" id="profile-inventory-count">0</div>
                        <div class="quick-stat-label">üéí –°–∫–∏–Ω–æ–≤</div>
                    </div>
                </div>
            </div>
            
            <!-- CS2 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ñ–µ–π–∫) -->
            <div class="card">
                <div class="card-title" data-i18n="profile.cs2Stats">üéØ CS2 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                <div class="cs2-stats">
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="stats.kdRatio">K/D Ratio</div>
                        <div class="cs2-stat-value" style="color: #00b894;">1.24</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="stats.headshot">Headshot %</div>
                        <div class="cs2-stat-value">47%</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="stats.matches">–ú–∞—Ç—á–µ–π</div>
                        <div class="cs2-stat-value">342</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="stats.wins">–ü–æ–±–µ–¥</div>
                        <div class="cs2-stat-value" style="color: #4facfe;">58%</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="stats.playTime">–í—Ä–µ–º—è –≤ –∏–≥—Ä–µ</div>
                        <div class="cs2-stat-value">847h</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="stats.rank">–†–∞–Ω–≥</div>
                        <div class="cs2-stat-value" style="color: #f7b733;">DMG</div>
                    </div>
                </div>
            </div>
            
            <!-- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã -->
            <div class="card">
                <div class="quests-header">
                    <div class="card-title" style="margin: 0;" data-i18n="profile.dailyQuests">üìã –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã</div>
                    <div class="daily-limit">
                        <span data-i18n="profile.today">–°–µ–≥–æ–¥–Ω—è</span>: <span class="daily-limit-value" id="daily-earned">0</span>/<span id="daily-max">20</span> ‚≠ê
                    </div>
                </div>
                <div id="quests-container"></div>
                <div style="margin-top: 15px; padding: 10px; background: #1c2733; border-radius: 8px; font-size: 12px; color: #8899a6;">
                    üí° –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—á–∫–∏ –∏–≥—Ä–∞—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –≤—ã–ø–æ–ª–Ω—è—è –∫–≤–µ—Å—Ç—ã. –õ–∏–º–∏—Ç: <strong style="color: #f7b733;">20 ‚≠ê</strong> –≤ –¥–µ–Ω—å.
                    <br>–î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ –Ω—É–∂–Ω–æ <strong style="color: #4facfe;">100 ‚≠ê</strong> (~5-6 –¥–Ω–µ–π).
                </div>
            </div>
            
            <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
            <div class="card">
                <div class="inventory-header">
                    <div style="display: flex; align-items: center;">
                        <div class="card-title" style="margin: 0;"><span data-i18n="profile.inventory">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</span> (<span id="inv-count">0</span>)</div>
                        <span id="selected-count" class="selected-count"></span>
                    </div>
                    <div class="inventory-actions">
                        <label class="select-all-label">
                            <input type="checkbox" id="select-all-checkbox" onchange="toggleSelectAll()">
                            <span data-i18n="inventory.all">–í—Å–µ</span>
                        </label>
                        <button id="sell-all-btn" class="btn btn-success" onclick="sellItems()" style="padding: 8px 12px; font-size: 11px;" data-i18n="inventory.sellAll">üí∞ –ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë</button>
                        <button id="withdraw-btn" class="btn btn-steam" onclick="withdrawItems()" style="padding: 8px 12px; font-size: 11px;" data-i18n="inventory.withdrawAll">üì§ –í—ã–≤–µ—Å—Ç–∏ –≤—Å—ë</button>
                    </div>
                </div>
                <div id="inventory-grid" class="inventory-grid"></div>
                <div id="inventory-pagination" class="inventory-pagination" style="display: none;">
                    <button class="pagination-btn" onclick="prevInventoryPage()">‚óÄ</button>
                    <div class="pagination-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ <span id="inv-current-page">1</span> –∏–∑ <span id="inv-total-pages">1</span></div>
                    <button class="pagination-btn" onclick="nextInventoryPage()">‚ñ∂</button>
                </div>
            </div>
        </div>

        <!-- ===== –≠–ö–†–ê–ù –ö–ï–ô–°–û–í ===== -->
        <div id="cases" class="screen">
            <div class="balance-bar">
                <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span> ‚≠ê</div>
                <button class="btn" onclick="addBalance()">+ 1000 ‚≠ê</button>
            </div>

            <div id="loading" class="loading-screen">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫–∏–Ω–æ–≤...</div>
            <div id="error" class="error-screen"></div>
            
            <div id="cases-grid" class="cases-grid"></div>
            <div id="carousel-container"></div>
        </div>

        <!-- ===== –≠–ö–†–ê–ù –°–¢–ê–¢–ò–°–¢–ò–ö–ò (–¢–û–ü) ===== -->
        <div id="stats" class="screen">
            <div class="card">
                <div class="card-title" data-i18n="top.serverTop">üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞</div>
                <div id="leaderboard"></div>
            </div>
            
            <div class="card">
                <div class="card-title" data-i18n="top.serverStats">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞</div>
                <div class="cs2-stats">
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="top.online">–û–Ω–ª–∞–π–Ω</div>
                        <div class="cs2-stat-value" style="color: #00b894;">47/64</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="top.totalPlayers">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤</div>
                        <div class="cs2-stat-value">12,847</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="top.casesOpened">–ö–µ–π—Å–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ</div>
                        <div class="cs2-stat-value">89,234</div>
                    </div>
                    <div class="cs2-stat">
                        <div class="cs2-stat-label" data-i18n="top.rareDrops">–†–µ–¥–∫–∏—Ö –¥—Ä–æ–ø–æ–≤</div>
                        <div class="cs2-stat-value" style="color: #eb4b4b;">1,247</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== –≠–ö–†–ê–ù –ù–ê–°–¢–†–û–ï–ö ===== -->
        <div id="settings" class="screen">
            <div class="card">
                <div class="card-title" data-i18n="settings.steamLink">üîó –ü—Ä–∏–≤—è–∑–∫–∞ Steam</div>
                
                <div class="settings-item">
                    <div class="settings-item-info">
                        <h4 data-i18n="settings.steamAccount">Steam –∞–∫–∫–∞—É–Ω—Ç</h4>
                        <p id="steam-status" data-i18n="settings.notLinked">–ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω</p>
                    </div>
                    <button class="btn btn-steam" onclick="linkSteam()" id="steam-btn">
                        üéÆ <span data-i18n="settings.link">–ü—Ä–∏–≤—è–∑–∞—Ç—å</span>
                    </button>
                </div>
                
                <div id="steam-info" style="display: none; margin-top: 15px;">
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <h4>Steam ID</h4>
                            <p id="steam-id">76561198123456789</p>
                        </div>
                        <span class="steam-linked">‚úì –ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title" data-i18n="settings.generalSettings">‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                
                <div class="settings-item">
                    <div class="settings-item-info">
                        <h4 data-i18n="settings.notifications">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h4>
                        <p data-i18n="settings.notificationsDesc">Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–¥–∫–∏—Ö –¥—Ä–æ–ø–∞—Ö</p>
                    </div>
                    <button class="btn" onclick="toggleNotifications()" style="padding: 8px 15px; font-size: 12px;" data-i18n="common.on">–í–∫–ª</button>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-info">
                        <h4 data-i18n="settings.sounds">–ó–≤—É–∫–∏</h4>
                        <p data-i18n="settings.soundsDesc">–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏</p>
                    </div>
                    <button class="btn" onclick="toggleSound()" style="padding: 8px 15px; font-size: 12px;" data-i18n="common.on">–í–∫–ª</button>
                </div>
            </div>
            
            <!-- Themes -->
            <div class="card">
                <div class="card-title" data-i18n="settings.theme">üé® –¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</div>
                <div class="settings-options" id="theme-options">
                    <div class="settings-option active" onclick="setTheme('standard')" data-theme-option="standard">
                        <div class="theme-preview standard"></div>
                        <span class="settings-option-label" data-i18n="settings.themeStandard">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è</span>
                    </div>
                    <div class="settings-option" onclick="setTheme('light')" data-theme-option="light">
                        <div class="theme-preview light"></div>
                        <span class="settings-option-label" data-i18n="settings.themeLight">–°–≤–µ—Ç–ª–∞—è</span>
                    </div>
                    <div class="settings-option" onclick="setTheme('dark')" data-theme-option="dark">
                        <div class="theme-preview dark"></div>
                        <span class="settings-option-label" data-i18n="settings.themeDark">–¢—ë–º–Ω–∞—è</span>
                    </div>
                </div>
            </div>
            
            <!-- Fonts -->
            <div class="card">
                <div class="card-title" data-i18n="settings.font">üî§ –®—Ä–∏—Ñ—Ç</div>
                <div class="settings-options" id="font-options">
                    <div class="settings-option active" onclick="setFont('standard')" data-font-option="standard">
                        <span class="font-preview">Aa</span>
                        <span class="settings-option-label" data-i18n="settings.fontStandard">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π</span>
                    </div>
                    <div class="settings-option" onclick="setFont('pixel')" data-font-option="pixel">
                        <span class="font-preview pixel">Aa</span>
                        <span class="settings-option-label">Press Start 2P</span>
                    </div>
                </div>
            </div>
            
            <!-- Language -->
            <div class="card">
                <div class="card-title" data-i18n="settings.language">üåê –Ø–∑—ã–∫</div>
                <div class="settings-options" id="language-options">
                    <div class="settings-option active" onclick="setLanguage('ru')" data-lang-option="ru">
                        <span class="settings-option-icon">üá∑üá∫</span>
                        <span class="settings-option-label">–†—É—Å—Å–∫–∏–π</span>
                    </div>
                    <div class="settings-option" onclick="setLanguage('en')" data-lang-option="en">
                        <span class="settings-option-icon">üá¨üáß</span>
                        <span class="settings-option-label">English</span>
                    </div>
                </div>
            </div>
            
            <!-- Currency -->
            <div class="card">
                <div class="card-title">üí∞ –í–∞–ª—é—Ç–∞ —Ü–µ–Ω</div>
                <div class="settings-options" id="currency-options">
                    <div class="settings-option active" onclick="setCurrency('RUB')" data-currency-option="RUB">
                        <span class="settings-option-icon">üá∑üá∫</span>
                        <span class="settings-option-label">‚ÇΩ –†—É–±–ª–∏</span>
                    </div>
                    <div class="settings-option" onclick="setCurrency('USD')" data-currency-option="USD">
                        <span class="settings-option-icon">üá∫üá∏</span>
                        <span class="settings-option-label">$ –î–æ–ª–ª–∞—Ä—ã</span>
                    </div>
                    <div class="settings-option" onclick="setCurrency('UAH')" data-currency-option="UAH">
                        <span class="settings-option-icon">üá∫üá¶</span>
                        <span class="settings-option-label">‚Ç¥ –ì—Ä–∏–≤–Ω—ã</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title" data-i18n="settings.data">üóëÔ∏è –î–∞–Ω–Ω—ã–µ</div>
                <button class="btn btn-danger" onclick="resetData()" style="width: 100%;" data-i18n="settings.resetData">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
            </div>
            
            <!-- –ê–¥–º–∏–Ω-–∫–Ω–æ–ø–∫–∞ (—Å –ø–∞—Ä–æ–ª–µ–º) -->
            <div class="card" id="admin-login-card">
                <div class="card-title" data-i18n="settings.admin">üîê –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                <div id="admin-login-form">
                    <input type="password" class="admin-input" id="admin-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞" style="margin-bottom:10px;">
                    <button class="btn" onclick="checkAdminPassword()" style="width: 100%; background: linear-gradient(90deg, #ff6b6b, #ee5a5a);">
                        üîì –í–æ–π—Ç–∏
                    </button>
                </div>
                <div id="admin-logged-in" style="display:none;">
                    <button class="btn" onclick="openAdminPanel()" style="width: 100%; background: linear-gradient(90deg, #ff6b6b, #ee5a5a);">
                        üõ†Ô∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                    </button>
                    <button class="btn btn-secondary" onclick="logoutAdmin()" style="width: 100%; margin-top: 10px;">
                        üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω–∫–∏
                    </button>
                </div>
                <p style="font-size: 11px; color: #8899a6; margin-top: 10px;">
                    –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                </p>
            </div>
        </div>

        <!-- ===== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===== -->
        <div id="admin-panel" class="admin-panel">
            <div class="admin-header">
                <div class="admin-title">üõ†Ô∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</div>
                <button class="btn btn-danger" onclick="closeAdminPanel()" style="padding: 8px 15px;">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
            
            <div class="admin-tabs">
                <div class="admin-tab active" onclick="switchAdminTab('cases')">üì¶ –ö–µ–π—Å—ã</div>
                <div class="admin-tab" onclick="switchAdminTab('create')">‚ûï –°–æ–∑–¥–∞—Ç—å</div>
                <div class="admin-tab" onclick="switchAdminTab('quests')">üìã –ö–≤–µ—Å—Ç—ã</div>
                <div class="admin-tab" onclick="switchAdminTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ –∫–µ–π—Å–æ–≤ -->
            <div id="admin-cases-tab">
                <div id="admin-case-list" class="admin-case-list"></div>
            </div>
            
            <!-- –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞ -->
            <div id="admin-create-tab" style="display: none;">
                <div class="admin-form">
                    <h3 id="admin-form-title">‚ûï –ù–æ–≤—ã–π –∫–µ–π—Å</h3>
                    <input type="hidden" id="admin-edit-id">
                    <input type="hidden" id="admin-edit-is-standard" value="false">
                    
                    <input type="text" class="admin-input" id="admin-case-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: üéÅ –ú–æ–π –∫–µ–π—Å)">
                    <input type="number" class="admin-input" id="admin-case-price" placeholder="–¶–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 100)">
                    <input type="text" class="admin-input" id="admin-case-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–µ–π—Å–∞">
                    
                    <div class="admin-skins-search">
                        <input type="text" class="admin-input" id="admin-skin-search" placeholder="üîç –ü–æ–∏—Å–∫ —Å–∫–∏–Ω–æ–≤..." oninput="filterAdminSkins()">
                        <div style="display: flex; gap: 10px;">
                            <select class="admin-input" id="admin-weapon-filter" onchange="filterAdminSkins()" style="flex:1;">
                                <option value="">üî´ –í—Å–µ –æ—Ä—É–∂–∏—è</option>
                                <option value="AK-47,M4A4,M4A1-S,Galil,FAMAS,SG 553,AUG">üí´ –í–∏–Ω—Ç–æ–≤–∫–∏</option>
                                <option value="AWP,SSG 08,SCAR-20,G3SG1">üéØ –°–Ω–∞–π–ø–µ—Ä—Å–∫–∏–µ</option>
                                <option value="Glock,USP-S,P2000,P250,Five-SeveN,Tec-9,CZ75,Desert Eagle,Dual Berettas,R8 Revolver">üî´ –ü–∏—Å—Ç–æ–ª–µ—Ç—ã</option>
                                <option value="MP9,MAC-10,MP7,MP5-SD,UMP-45,PP-Bizon,P90">üî´ –ü–ü</option>
                                <option value="Nova,XM1014,MAG-7,Sawed-Off">üí• –î—Ä–æ–±–æ–≤–∏–∫–∏</option>
                                <option value="M249,Negev">üí£ –ü—É–ª–µ–º—ë—Ç—ã</option>
                                <option value="category:Knives">üó°Ô∏è –ù–æ–∂–∏</option>
                                <option value="category:Gloves">üß§ –ü–µ—Ä—á–∞—Ç–∫–∏</option>
                            </select>
                            <select class="admin-input" id="admin-rarity-filter" onchange="filterAdminSkins()" style="flex:1;">
                                <option value="">‚ú® –í—Å–µ —Ä–µ–¥–∫–æ—Å—Ç–∏</option>
                                <option value="Extraordinary">‚≠ê Extraordinary (–ù–æ–∂–∏/–ü–µ—Ä—á–∞—Ç–∫–∏)</option>
                                <option value="Contraband">üî¥ Contraband</option>
                                <option value="Covert">üî¥ Covert</option>
                                <option value="Classified">üü£ Classified</option>
                                <option value="Restricted">üü£ Restricted</option>
                                <option value="Mil-Spec Grade">üîµ Mil-Spec Grade</option>
                                <option value="Industrial Grade">üîµ Industrial Grade</option>
                                <option value="Consumer Grade">‚ö™ Consumer Grade</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="admin-skins-grid" class="admin-skins-grid"></div>
                    
                    <div class="admin-selected-skins">
                        <h4>‚úÖ –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–∫–∏–Ω—ã (<span id="admin-selected-count">0</span>):</h4>
                        <div id="admin-selected-list" class="admin-selected-list"></div>
                    </div>
                    
                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="btn btn-success" onclick="saveAdminCase()" style="flex: 1;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–µ–π—Å</button>
                        <button class="btn btn-secondary" onclick="clearAdminForm()" style="flex: 1;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>
            </div>
            
            <!-- –†–µ–¥–∞–∫—Ç–æ—Ä –∫–≤–µ—Å—Ç–æ–≤ -->
            <div id="admin-quests-tab" style="display: none;">
                <div class="admin-form">
                    <h3>üìã –†–µ–¥–∞–∫—Ç–æ—Ä –∫–≤–µ—Å—Ç–æ–≤</h3>
                    <p style="font-size: 12px; color: #8899a6; margin-bottom: 15px;">
                        –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–∏ –∫–≤–µ—Å—Ç—ã –∏–∑ –ø—É–ª–∞ –∑–∞–¥–∞–Ω–∏–π. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –∏–≥—Ä–æ–∫–∞–º –±—É–¥–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å—Å—è 4 —Å–ª—É—á–∞–π–Ω—ã—Ö –∫–≤–µ—Å—Ç–∞ –∏–∑ –≤–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞.
                    </p>
                    
                    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–≤–µ—Å—Ç–∞ -->
                    <div style="background: #243447; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 15px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–≤–µ—Å—Ç</h4>
                        <div style="display: grid; gap: 10px;">
                            <select id="quest-type-select" class="admin-input" style="width: 100%;">
                                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–≤–µ—Å—Ç–∞ --</option>
                            </select>
                            <div style="display: flex; gap: 10px;">
                                <input type="number" id="quest-target-input" class="admin-input" placeholder="–°–∫–æ–ª—å–∫–æ —Ä–∞–∑" min="1" value="5" style="flex: 1;">
                                <input type="number" id="quest-reward-input" class="admin-input" placeholder="–ù–∞–≥—Ä–∞–¥–∞ ‚≠ê" min="1" value="4" style="flex: 1;">
                            </div>
                            <button class="btn btn-success" onclick="addCustomQuest()" style="width: 100%;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–≤–µ—Å—Ç</button>
                        </div>
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –∫–≤–µ—Å—Ç–æ–≤ -->
                    <div>
                        <h4 style="margin-bottom: 10px;">üìú –¢–µ–∫—É—â–∏–π –ø—É–ª –∫–≤–µ—Å—Ç–æ–≤ (<span id="quest-pool-count">0</span>)</h4>
                        <div id="quest-pool-list" style="display: flex; flex-direction: column; gap: 8px;"></div>
                    </div>
                    
                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="resetQuestsToDefault()" style="flex: 1;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º</button>
                        <button class="btn btn-danger" onclick="forceNewDailyQuests()" style="flex: 1;">üé≤ –û–±–Ω–æ–≤–∏—Ç—å –¥–Ω–µ–≤–Ω—ã–µ</button>
                    </div>
                </div>
            </div>
            
            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ -->
            <div id="admin-settings-tab" style="display: none;">
                <div class="admin-form">
                    <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #243447; border-radius: 10px; cursor: pointer;">
                            <input type="checkbox" id="admin-sell-toggle" onchange="toggleShopSetting('sell')" style="width: 20px; height: 20px; cursor: pointer;">
                            <div>
                                <div style="font-weight: bold;">üí∞ –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                                <div style="font-size: 12px; color: #8899a6;">–†–∞–∑—Ä–µ—à–∏—Ç—å –∏–≥—Ä–æ–∫–∞–º –ø—Ä–æ–¥–∞–≤–∞—Ç—å —Å–∫–∏–Ω—ã –∑–∞ –æ—á–∫–∏</div>
                            </div>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #243447; border-radius: 10px; cursor: pointer;">
                            <input type="checkbox" id="admin-withdraw-toggle" onchange="toggleShopSetting('withdraw')" style="width: 20px; height: 20px; cursor: pointer;">
                            <div>
                                <div style="font-weight: bold;">üì§ –í—ã–≤–æ–¥ –Ω–∞ Steam</div>
                                <div style="font-size: 12px; color: #8899a6;">–†–∞–∑—Ä–µ—à–∏—Ç—å –∏–≥—Ä–æ–∫–∞–º –≤—ã–≤–æ–¥–∏—Ç—å —Å–∫–∏–Ω—ã –Ω–∞ Steam –∞–∫–∫–∞—É–Ω—Ç</div>
                            </div>
                        </label>
                    </div>
                    
                    <div style="padding: 15px; background: #1c2733; border-radius: 10px; border-left: 3px solid #f7b733;">
                        <div style="font-size: 12px; color: #8899a6;">
                            ‚ö†Ô∏è <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –û—Ç–∫–ª—é—á—ë–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
                        </div>
                    </div>
                </div>
                
                <!-- –≠–∫—Å–ø–æ—Ä—Ç —Å–∫–∏–Ω–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω -->
                <div class="admin-form" style="margin-top: 20px;">
                    <h3>üí∞ –¶–µ–Ω—ã —Å–æ Steam Market</h3>
                    
                    <div style="padding: 15px; background: #243447; border-radius: 10px; margin-bottom: 15px;">
                        <div style="font-size: 13px; margin-bottom: 10px;">
                            –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–æ–∫ —Å–∫–∏–Ω–æ–≤ –∏–∑ –≤—Å–µ—Ö –∫–µ–π—Å–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω —Å–æ Steam Market.
                        </div>
                        <div style="font-size: 11px; color: #8899a6;">
                            1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ<br>
                            2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª <strong>case-skins.json</strong> –≤ –ø–∞–ø–∫—É —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º<br>
                            3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: <code style="background: #1c2733; padding: 2px 6px; border-radius: 4px;">node fetch-prices.js</code>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="exportCaseSkinsForPrices()" style="width: 100%;">
                        üì• –≠–∫—Å–ø–æ—Ä—Ç —Å–∫–∏–Ω–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω
                    </button>
                    
                    <div id="export-stats" style="margin-top: 10px; font-size: 12px; color: #8899a6;"></div>
                </div>
            </div>
        </div>

        <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–û–î–ï–†–ñ–ò–ú–û–ì–û –ö–ï–ô–°–ê ===== -->
        <div id="case-modal" class="case-modal" onclick="if(event.target === this) closeCaseModal()">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">üéÅ <span id="modal-case-name">–ö–µ–π—Å</span></div>
                    <button class="modal-close" onclick="closeCaseModal()">‚úï</button>
                </div>
                <div id="modal-skins-grid"></div>
            </div>
        </div>

        <!-- ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== -->
        <div class="menu">
            <div class="menu-item active" id="btn-profile" onclick="openTab('profile')">
                <span class="menu-icon">üë§</span>
                –ü—Ä–æ—Ñ–∏–ª—å
            </div>
            <div class="menu-item" id="btn-cases" onclick="openTab('cases')">
                <span class="menu-icon">üé∞</span>
                –ö–µ–π—Å—ã
            </div>
            <div class="menu-item" id="btn-stats" onclick="openTab('stats')">
                <span class="menu-icon">üèÜ</span>
                –¢–æ–ø
            </div>
            <div class="menu-item" id="btn-settings" onclick="openTab('settings')">
                <span class="menu-icon">‚öôÔ∏è</span>
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </div>
        </div>
    </div>

    <script src="app.bundle.js"></script>
    
    <script>
        let app = null;
        let steamLinked = localStorage.getItem('steamLinked') === 'true';
        let currentTheme = localStorage.getItem('cs2_theme') || 'standard';
        let currentFont = localStorage.getItem('cs2_font') || 'standard';
        let currentLanguage = localStorage.getItem('cs2_language') || 'ru';
        
        // ===== TRANSLATIONS =====
        const translations = {
            ru: {
                // Navigation
                'nav.profile': '–ü—Ä–æ—Ñ–∏–ª—å',
                'nav.cases': '–ö–µ–π—Å—ã',
                'nav.top': '–¢–æ–ø',
                'nav.settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                
                // Profile
                'profile.balance': '–ë–∞–ª–∞–Ω—Å',
                'profile.casesOpened': '–ö–µ–π—Å–æ–≤',
                'profile.skins': '–°–∫–∏–Ω–æ–≤',
                'profile.cs2Stats': 'CS2 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                'profile.dailyQuests': '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã',
                'profile.inventory': '–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å',
                'profile.today': '–°–µ–≥–æ–¥–Ω—è',
                
                // Stats labels
                'stats.kdRatio': 'K/D Ratio',
                'stats.headshot': 'Headshot %',
                'stats.matches': '–ú–∞—Ç—á–µ–π',
                'stats.wins': '–ü–æ–±–µ–¥',
                'stats.playTime': '–í—Ä–µ–º—è –≤ –∏–≥—Ä–µ',
                'stats.rank': '–†–∞–Ω–≥',
                
                // Settings
                'settings.steamLink': '–ü—Ä–∏–≤—è–∑–∫–∞ Steam',
                'settings.steamAccount': 'Steam –∞–∫–∫–∞—É–Ω—Ç',
                'settings.notLinked': '–ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω',
                'settings.link': '–ü—Ä–∏–≤—è–∑–∞—Ç—å',
                'settings.generalSettings': '–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏',
                'settings.notifications': '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
                'settings.notificationsDesc': 'Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–¥–∫–∏—Ö –¥—Ä–æ–ø–∞—Ö',
                'settings.sounds': '–ó–≤—É–∫–∏',
                'settings.soundsDesc': '–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏',
                'settings.theme': 'üé® –¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è',
                'settings.themeStandard': '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è',
                'settings.themeLight': '–°–≤–µ—Ç–ª–∞—è',
                'settings.themeDark': '–¢—ë–º–Ω–∞—è',
                'settings.font': 'üî§ –®—Ä–∏—Ñ—Ç',
                'settings.fontStandard': '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π',
                'settings.language': 'üåê –Ø–∑—ã–∫',
                'settings.data': 'üóëÔ∏è –î–∞–Ω–Ω—ã–µ',
                'settings.resetData': '–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ',
                'settings.admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ',
                
                // Cases
                'cases.balance': '–ë–∞–ª–∞–Ω—Å',
                'cases.loading': '–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫–∏–Ω–æ–≤...',
                'cases.skinsInside': '—Å–∫–∏–Ω–æ–≤ –≤–Ω—É—Ç—Ä–∏',
                'cases.open': '–û—Ç–∫—Ä—ã—Ç—å',
                'cases.contents': '–°–æ–¥–µ—Ä–∂–∏–º–æ–µ',
                
                // Inventory
                'inventory.sell': '–ü—Ä–æ–¥–∞—Ç—å',
                'inventory.withdraw': '–í—ã–≤–µ—Å—Ç–∏',
                'inventory.sellAll': '–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë',
                'inventory.withdrawAll': '–í—ã–≤–µ—Å—Ç–∏ –≤—Å—ë',
                'inventory.all': '–í—Å–µ',
                'inventory.page': '–°—Ç—Ä–∞–Ω–∏—Ü–∞',
                'inventory.of': '–∏–∑',
                
                // Top
                'top.serverTop': '–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞',
                'top.serverStats': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞',
                'top.online': '–û–Ω–ª–∞–π–Ω',
                'top.totalPlayers': '–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤',
                'top.casesOpened': '–ö–µ–π—Å–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ',
                'top.rareDrops': '–†–µ–¥–∫–∏—Ö –¥—Ä–æ–ø–æ–≤',
                
                // Common
                'common.on': '–í–∫–ª',
                'common.off': '–í—ã–∫–ª',
                'common.close': '–ó–∞–∫—Ä—ã—Ç—å',
                'common.save': '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
                'common.cancel': '–û—Ç–º–µ–Ω–∞'
            },
            en: {
                // Navigation
                'nav.profile': 'Profile',
                'nav.cases': 'Cases',
                'nav.top': 'Top',
                'nav.settings': 'Settings',
                
                // Profile
                'profile.balance': 'Balance',
                'profile.casesOpened': 'Cases',
                'profile.skins': 'Skins',
                'profile.cs2Stats': 'CS2 Statistics',
                'profile.dailyQuests': 'Daily Quests',
                'profile.inventory': 'Inventory',
                'profile.today': 'Today',
                
                // Stats labels
                'stats.kdRatio': 'K/D Ratio',
                'stats.headshot': 'Headshot %',
                'stats.matches': 'Matches',
                'stats.wins': 'Wins',
                'stats.playTime': 'Play Time',
                'stats.rank': 'Rank',
                
                // Settings
                'settings.steamLink': 'Steam Link',
                'settings.steamAccount': 'Steam Account',
                'settings.notLinked': 'Not linked',
                'settings.link': 'Link',
                'settings.generalSettings': 'General Settings',
                'settings.notifications': 'Notifications',
                'settings.notificationsDesc': 'Push notifications for rare drops',
                'settings.sounds': 'Sounds',
                'settings.soundsDesc': 'Sound effects when opening',
                'settings.theme': 'üé® Theme',
                'settings.themeStandard': 'Standard',
                'settings.themeLight': 'Light',
                'settings.themeDark': 'Dark',
                'settings.font': 'üî§ Font',
                'settings.fontStandard': 'Standard',
                'settings.language': 'üåê Language',
                'settings.data': 'üóëÔ∏è Data',
                'settings.resetData': 'Reset all data',
                'settings.admin': 'Administration',
                
                // Cases
                'cases.balance': 'Balance',
                'cases.loading': 'Loading skins...',
                'cases.skinsInside': 'skins inside',
                'cases.open': 'Open',
                'cases.contents': 'Contents',
                
                // Inventory
                'inventory.sell': 'Sell',
                'inventory.withdraw': 'Withdraw',
                'inventory.sellAll': 'Sell All',
                'inventory.withdrawAll': 'Withdraw All',
                'inventory.all': 'All',
                'inventory.page': 'Page',
                'inventory.of': 'of',
                
                // Top
                'top.serverTop': 'Server Top Players',
                'top.serverStats': 'Server Statistics',
                'top.online': 'Online',
                'top.totalPlayers': 'Total Players',
                'top.casesOpened': 'Cases Opened',
                'top.rareDrops': 'Rare Drops',
                
                // Common
                'common.on': 'On',
                'common.off': 'Off',
                'common.close': 'Close',
                'common.save': 'Save',
                'common.cancel': 'Cancel'
            }
        };
        
        // ===== THEME SYSTEM =====
        function setTheme(theme) {
            currentTheme = theme;
            localStorage.setItem('cs2_theme', theme);
            
            if (theme === 'standard') {
                document.documentElement.removeAttribute('data-theme');
            } else {
                document.documentElement.setAttribute('data-theme', theme);
            }
            
            // Update active state
            document.querySelectorAll('[data-theme-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.themeOption === theme);
            });
        }
        
        // ===== FONT SYSTEM =====
        function setFont(font) {
            currentFont = font;
            localStorage.setItem('cs2_font', font);
            
            document.documentElement.setAttribute('data-font', font);
            
            // Update active state
            document.querySelectorAll('[data-font-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.fontOption === font);
            });
        }
        
        // ===== LANGUAGE SYSTEM =====
        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('cs2_language', lang);
            
            // Update active state
            document.querySelectorAll('[data-lang-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.langOption === lang);
            });
            
            // Apply translations
            applyTranslations();
        }
        
        function t(key) {
            return translations[currentLanguage]?.[key] || translations['ru'][key] || key;
        }
        
        function applyTranslations() {
            // Update elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.dataset.i18n;
                const translation = t(key);
                
                // Handle special cases with emojis
                if (key === 'inventory.sellAll') {
                    el.textContent = `üí∞ ${currentLanguage === 'en' ? 'Sell All' : '–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë'}`;
                } else if (key === 'inventory.withdrawAll') {
                    el.textContent = `üì§ ${currentLanguage === 'en' ? 'Withdraw All' : '–í—ã–≤–µ—Å—Ç–∏ –≤—Å—ë'}`;
                } else if (key === 'profile.inventory') {
                    el.textContent = `üéí ${currentLanguage === 'en' ? 'Inventory' : '–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å'}`;
                } else if (key === 'profile.dailyQuests') {
                    el.textContent = `üìã ${currentLanguage === 'en' ? 'Daily Quests' : '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã'}`;
                } else if (key === 'profile.cs2Stats') {
                    el.textContent = `üéØ ${currentLanguage === 'en' ? 'CS2 Statistics' : 'CS2 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞'}`;
                } else if (key === 'settings.steamLink') {
                    el.textContent = `üîó ${currentLanguage === 'en' ? 'Steam Link' : '–ü—Ä–∏–≤—è–∑–∫–∞ Steam'}`;
                } else if (key === 'settings.generalSettings') {
                    el.textContent = `‚öôÔ∏è ${currentLanguage === 'en' ? 'General Settings' : '–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏'}`;
                } else if (key === 'settings.admin') {
                    el.textContent = `üîê ${currentLanguage === 'en' ? 'Administration' : '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ'}`;
                } else if (key === 'top.serverTop') {
                    el.textContent = `üèÜ ${currentLanguage === 'en' ? 'Server Top Players' : '–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞'}`;
                } else if (key === 'top.serverStats') {
                    el.textContent = `üìä ${currentLanguage === 'en' ? 'Server Statistics' : '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞'}`;
                } else {
                    el.textContent = translation;
                }
            });
            
            // Update navigation
            const navProfile = document.querySelector('#btn-profile');
            const navCases = document.querySelector('#btn-cases');
            const navStats = document.querySelector('#btn-stats');
            const navSettings = document.querySelector('#btn-settings');
            
            if (navProfile) navProfile.innerHTML = `<span class="menu-icon">üë§</span>${t('nav.profile')}`;
            if (navCases) navCases.innerHTML = `<span class="menu-icon">üé∞</span>${t('nav.cases')}`;
            if (navStats) navStats.innerHTML = `<span class="menu-icon">üèÜ</span>${t('nav.top')}`;
            if (navSettings) navSettings.innerHTML = `<span class="menu-icon">‚öôÔ∏è</span>${t('nav.settings')}`;
            
            // Update stat labels in profile
            const statLabels = document.querySelectorAll('.quick-stat-label');
            if (statLabels[0]) statLabels[0].innerHTML = `‚≠ê ${t('profile.balance')}`;
            if (statLabels[1]) statLabels[1].innerHTML = `üì¶ ${t('profile.casesOpened')}`;
            if (statLabels[2]) statLabels[2].innerHTML = `üéí ${t('profile.skins')}`;
            
            // Update loading text
            const loadingEl = document.getElementById('loading');
            if (loadingEl) loadingEl.textContent = `‚è≥ ${t('cases.loading')}`;
            
            // Update balance bar
            const balanceBar = document.querySelector('.balance');
            if (balanceBar) {
                const balanceValue = document.getElementById('balance')?.textContent || '0';
                balanceBar.innerHTML = `${t('cases.balance')}: <span id="balance">${balanceValue}</span> ‚≠ê`;
            }
        }
        
        // Initialize settings on page load
        function initSettings() {
            // Apply saved theme
            if (currentTheme !== 'standard') {
                document.documentElement.setAttribute('data-theme', currentTheme);
            }
            document.querySelectorAll('[data-theme-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.themeOption === currentTheme);
            });
            
            // Apply saved font
            document.documentElement.setAttribute('data-font', currentFont);
            document.querySelectorAll('[data-font-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.fontOption === currentFont);
            });
            
            // Apply saved language
            document.querySelectorAll('[data-lang-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.langOption === currentLanguage);
            });
            
            // Apply saved currency
            const currentCurrency = localStorage.getItem('cs2_currency') || 'RUB';
            document.querySelectorAll('[data-currency-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.currencyOption === currentCurrency);
            });
            
            applyTranslations();
        }
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∞–ª—é—Ç—ã
        function setCurrency(currency) {
            localStorage.setItem('cs2_currency', currency);
            
            document.querySelectorAll('[data-currency-option]').forEach(el => {
                el.classList.toggle('active', el.dataset.currencyOption === currency);
            });
            
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å –Ω–æ–≤–æ–π –≤–∞–ª—é—Ç–æ–π
            renderInventory();
        }

        // ===== –°–ò–°–¢–ï–ú–ê –ö–í–ï–°–¢–û–í =====
        const DAILY_POINTS_LIMIT = 20;
        const CASE_COST = 100;
        
        // –ü—É–ª —à–∞–±–ª–æ–Ω–æ–≤ –∫–≤–µ—Å—Ç–æ–≤ (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ localStorage –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ)
        function getQuestTemplates() {
            const saved = localStorage.getItem('cs2_quest_templates');
            if (saved) {
                return JSON.parse(saved);
            }
            return DEFAULT_QUEST_TEMPLATES;
        }
        
        // –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
        const DEFAULT_QUEST_TEMPLATES = [
            { id: 'play_matches', title: 'üéÆ –°—ã–≥—Ä–∞—Ç—å –º–∞—Ç—á–∏', description: '–°—ã–≥—Ä–∞–π—Ç–µ 3 –º–∞—Ç—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ', target: 3, reward: 5, icon: 'üéÆ' },
            { id: 'win_rounds', title: 'üèÜ –ü–æ–±–µ–¥–∏—Ç—å –≤ —Ä–∞—É–Ω–¥–∞—Ö', description: '–í—ã–∏–≥—Ä–∞–π—Ç–µ 10 —Ä–∞—É–Ω–¥–æ–≤', target: 10, reward: 4, icon: 'üèÜ' },
            { id: 'get_kills', title: 'üíÄ –£–±–∏–π—Å—Ç–≤–∞', description: '–°–æ–≤–µ—Ä—à–∏—Ç–µ 15 —É–±–∏–π—Å—Ç–≤', target: 15, reward: 5, icon: 'üíÄ' },
            { id: 'headshots', title: 'üéØ –•–µ–¥—à–æ—Ç—ã', description: '–°–æ–≤–µ—Ä—à–∏—Ç–µ 5 —É–±–∏–π—Å—Ç–≤ –≤ –≥–æ–ª–æ–≤—É', target: 5, reward: 4, icon: 'üéØ' },
            { id: 'play_time', title: '‚è±Ô∏è –í—Ä–µ–º—è –≤ –∏–≥—Ä–µ', description: '–ü—Ä–æ–≤–µ–¥–∏—Ç–µ 30 –º–∏–Ω—É—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ', target: 30, reward: 6, icon: '‚è±Ô∏è' },
            { id: 'use_grenades', title: 'üí£ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞–Ω–∞—Ç—ã', description: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 10 –≥—Ä–∞–Ω–∞—Ç', target: 10, reward: 3, icon: 'üí£' },
            { id: 'plant_bomb', title: 'üí• –ó–∞–ª–æ–∂–∏—Ç—å –±–æ–º–±—É', description: '–ó–∞–ª–æ–∂–∏—Ç–µ –±–æ–º–±—É 2 —Ä–∞–∑–∞', target: 2, reward: 4, icon: 'üí•' },
            { id: 'defuse_bomb', title: 'üîß –†–∞–∑–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å', description: '–†–∞–∑–º–∏–Ω–∏—Ä—É–π—Ç–µ –±–æ–º–±—É 1 —Ä–∞–∑', target: 1, reward: 5, icon: 'üîß' }
        ];
        
        // –ü—É–ª —Ç–∏–ø–æ–≤ –∫–≤–µ—Å—Ç–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        const QUEST_TYPES_POOL = [
            { id: 'play_matches', icon: 'üéÆ', label: '–°—ã–≥—Ä–∞—Ç—å –º–∞—Ç—á–µ–π', unit: '–º–∞—Ç—á–µ–π' },
            { id: 'win_rounds', icon: 'üèÜ', label: '–í—ã–∏–≥—Ä–∞—Ç—å —Ä–∞—É–Ω–¥–æ–≤', unit: '—Ä–∞—É–Ω–¥–æ–≤' },
            { id: 'get_kills', icon: 'üíÄ', label: '–£–±–∏–π—Å—Ç–≤', unit: '—É–±–∏–π—Å—Ç–≤' },
            { id: 'headshots', icon: 'üéØ', label: '–•–µ–¥—à–æ—Ç–æ–≤', unit: '—Ö–µ–¥—à–æ—Ç–æ–≤' },
            { id: 'play_time', icon: '‚è±Ô∏è', label: '–ú–∏–Ω—É—Ç –≤ –∏–≥—Ä–µ', unit: '–º–∏–Ω—É—Ç' },
            { id: 'use_grenades', icon: 'üí£', label: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞–Ω–∞—Ç', unit: '–≥—Ä–∞–Ω–∞—Ç' },
            { id: 'plant_bomb', icon: 'üí•', label: '–ó–∞–ª–æ–∂–∏—Ç—å –±–æ–º–±—É', unit: '—Ä–∞–∑' },
            { id: 'defuse_bomb', icon: 'üîß', label: '–†–∞–∑–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å', unit: '—Ä–∞–∑' },
            { id: 'mvp', icon: '‚≠ê', label: '–°—Ç–∞—Ç—å MVP', unit: '—Ä–∞–∑' },
            { id: 'knife_kills', icon: 'üî™', label: '–£–±–∏–π—Å—Ç–≤ –Ω–æ–∂–æ–º', unit: '—É–±–∏–π—Å—Ç–≤' },
            { id: 'pistol_kills', icon: 'üî´', label: '–£–±–∏–π—Å—Ç–≤ –∏–∑ –ø–∏—Å—Ç–æ–ª–µ—Ç–∞', unit: '—É–±–∏–π—Å—Ç–≤' },
            { id: 'win_match', icon: 'ü•á', label: '–í—ã–∏–≥—Ä–∞—Ç—å –º–∞—Ç—á', unit: '—Ä–∞–∑' },
            { id: 'damage_dealt', icon: 'üí•', label: '–ù–∞–Ω–µ—Å—Ç–∏ —É—Ä–æ–Ω–∞', unit: '—É—Ä–æ–Ω–∞' },
            { id: 'assists', icon: 'ü§ù', label: '–ê—Å—Å–∏—Å—Ç–æ–≤', unit: '–∞—Å—Å–∏—Å—Ç–æ–≤' }
        ];
        
        function getQuestData() {
            const saved = localStorage.getItem('cs2_quests');
            if (saved) {
                const data = JSON.parse(saved);
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ –∫–≤–µ—Å—Ç—ã
                const today = new Date().toDateString();
                if (data.date === today) {
                    return data;
                }
            }
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –∫–≤–µ—Å—Ç—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
            return generateDailyQuests();
        }
        
        function generateDailyQuests() {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –µ—Å–ª–∏ –µ—Å—Ç—å
            const templates = getQuestTemplates();
            // –í—ã–±–∏—Ä–∞–µ–º 4 —Å–ª—É—á–∞–π–Ω—ã—Ö –∫–≤–µ—Å—Ç–∞ –Ω–∞ –¥–µ–Ω—å
            const shuffled = [...templates].sort(() => 0.5 - Math.random());
            const dailyQuests = shuffled.slice(0, 4).map(q => ({
                ...q,
                progress: 0,
                claimed: false
            }));
            
            const data = {
                date: new Date().toDateString(),
                quests: dailyQuests,
                earnedToday: 0
            };
            
            saveQuestData(data);
            return data;
        }
        
        function saveQuestData(data) {
            localStorage.setItem('cs2_quests', JSON.stringify(data));
        }
        
        function renderQuests() {
            const container = document.getElementById('quests-container');
            const questData = getQuestData();
            
            document.getElementById('daily-earned').textContent = questData.earnedToday;
            document.getElementById('daily-max').textContent = DAILY_POINTS_LIMIT;
            
            let html = '';
            questData.quests.forEach((quest, index) => {
                const progressPercent = Math.min(100, (quest.progress / quest.target) * 100);
                const isComplete = quest.progress >= quest.target;
                const canClaim = isComplete && !quest.claimed && questData.earnedToday < DAILY_POINTS_LIMIT;
                const actualReward = Math.min(quest.reward, DAILY_POINTS_LIMIT - questData.earnedToday);
                
                html += `
                    <div class="quest-item ${quest.claimed ? 'quest-completed' : ''}">
                        <div class="quest-info">
                            <div class="quest-title">${quest.title}</div>
                            <div class="quest-description">${quest.description}</div>
                            <div class="quest-progress">
                                <div class="quest-progress-bar">
                                    <div class="quest-progress-fill" style="width: ${progressPercent}%"></div>
                                </div>
                                <div class="quest-progress-text">${quest.progress}/${quest.target}</div>
                            </div>
                        </div>
                        <div class="quest-reward">
                            <div class="quest-reward-value">${quest.claimed ? '‚úì' : '+' + quest.reward}</div>
                            <div class="quest-reward-label">${quest.claimed ? '–ü–æ–ª—É—á–µ–Ω–æ' : '–æ—á–∫–æ–≤'}</div>
                            ${canClaim ? `<button class="quest-btn quest-btn-claim" onclick="claimQuest(${index})">–ó–∞–±—Ä–∞—Ç—å</button>` : ''}
                            ${!isComplete && !quest.claimed ? `<button class="quest-btn quest-btn-disabled" onclick="simulateQuestProgress(${index})">‚ñ∂Ô∏è –°–∏–º—É–ª.</button>` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function claimQuest(index) {
            const questData = getQuestData();
            const quest = questData.quests[index];
            
            if (quest.claimed || quest.progress < quest.target) return;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É —Å —É—á—ë—Ç–æ–º –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
            const reward = Math.min(quest.reward, DAILY_POINTS_LIMIT - questData.earnedToday);
            if (reward <= 0) {
                alert('‚ùå –î–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –æ—á–∫–æ–≤!');
                return;
            }
            
            quest.claimed = true;
            questData.earnedToday += reward;
            saveQuestData(questData);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ –∫ –±–∞–ª–∞–Ω—Å—É
            if (app && app.player) {
                app.player.addBalance(reward);
                app.player.save();
                updateUI();
            }
            
            renderQuests();
            alert(`‚úÖ –ü–æ–ª—É—á–µ–Ω–æ ${reward} ‚≠ê!`);
        }
        
        // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–≤–µ—Å—Ç–∞ (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏)
        function simulateQuestProgress(index) {
            const questData = getQuestData();
            const quest = questData.quests[index];
            
            if (quest.claimed) return;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
            const add = Math.ceil(quest.target * 0.3) + Math.floor(Math.random() * quest.target * 0.3);
            quest.progress = Math.min(quest.target, quest.progress + add);
            
            saveQuestData(questData);
            renderQuests();
            
            if (quest.progress >= quest.target) {
                alert(`üéâ –ö–≤–µ—Å—Ç "${quest.title}" –≤—ã–ø–æ–ª–Ω–µ–Ω! –ó–∞–±–µ—Ä–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—É.`);
            }
        }

        // ===== –§–ï–ô–ö–û–í–´–ï –ò–ì–†–û–ö–ò –î–õ–Ø –õ–ò–î–ï–†–ë–û–†–î–ê =====
        const fakeLeaderboard = [
            { name: 'xXx_HeadHunter_xXx', cases: 1247, hours: 1847, kd: 2.15 },
            { name: 'Pro100_Killer', cases: 982, hours: 1523, kd: 1.89 },
            { name: 'AceShooter', cases: 876, hours: 1298, kd: 1.76 },
            { name: 'SniperElite', cases: 754, hours: 1156, kd: 1.65 },
            { name: 'FlashBang_Master', cases: 698, hours: 987, kd: 1.54 },
            { name: 'CS_Veteran', cases: 623, hours: 876, kd: 1.48 },
            { name: 'RushB_NoStop', cases: 567, hours: 754, kd: 1.42 },
            { name: 'OneClickHS', cases: 512, hours: 623, kd: 1.38 },
            { name: 'NightOwl', cases: 489, hours: 512, kd: 1.31 },
            { name: 'ToxicPlayer', cases: 423, hours: 398, kd: 1.25 }
        ];

        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        function openTab(tab) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            document.getElementById('btn-' + tab).classList.add('active');
            
            if (app) updateUI();
            if (tab === 'profile') renderQuests();
            if (tab === 'stats') renderLeaderboard();
            if (tab === 'settings') updateSteamStatus();
        }

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        async function initApp() {
            try {
                app = new CS2App();
                await app.init();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ü–µ–Ω—ã —Å–æ Steam Market
                await loadSteamPrices();
                
                document.getElementById('loading').style.display = 'none';
                
                renderCases();
                renderLeaderboard();
                renderQuests();
                updateUI();
                updateSteamStatus();
                updateShopButtons();
                
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                document.getElementById('error').textContent = '‚ùå –û—à–∏–±–∫–∞: ' + error.message;
                console.error(error);
            }
        }

        // ===== –û–¢–†–ò–°–û–í–ö–ê –ö–ï–ô–°–û–í =====
        function renderCases() {
            const casesGrid = document.getElementById('cases-grid');
            const cases = app.getCases();
            
            casesGrid.innerHTML = '';
            
            cases.forEach(caseData => {
                const card = document.createElement('div');
                card.className = 'case-card';
                
                card.innerHTML = `
                    <div class="case-header">
                        <div class="case-name">${caseData.name}</div>
                        <div class="case-price">${caseData.price} ‚≠ê</div>
                    </div>
                    <div class="case-desc">${caseData.description}</div>
                    <div class="case-info">üéÅ ${caseData.skins.length} —Å–∫–∏–Ω–æ–≤ –≤–Ω—É—Ç—Ä–∏</div>
                    <div class="case-buttons">
                        <button class="btn btn-secondary" onclick="event.stopPropagation(); showCaseContents('${caseData.id}')">üìã –ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                        <button class="btn" onclick="event.stopPropagation(); openCase('${caseData.id}')">üé∞ –û—Ç–∫—Ä—ã—Ç—å</button>
                    </div>
                `;
                
                casesGrid.appendChild(card);
            });
        }
        
        // ===== –ü–û–ö–ê–ó–ê–¢–¨ –°–û–î–ï–†–ñ–ò–ú–û–ï –ö–ï–ô–°–ê =====
        function showCaseContents(caseId) {
            const cases = app.getCases();
            const caseData = cases.find(c => c.id === caseId);
            if (!caseData) return;
            
            const modal = document.getElementById('case-modal');
            const modalTitle = document.getElementById('modal-case-name');
            const modalGrid = document.getElementById('modal-skins-grid');
            
            modalTitle.textContent = caseData.name;
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å–∫–∏–Ω—ã –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
            const skinsByRarity = {};
            caseData.skins.forEach(skin => {
                const rarity = skin.rarity?.name || 'Unknown';
                if (!skinsByRarity[rarity]) skinsByRarity[rarity] = [];
                skinsByRarity[rarity].push(skin);
            });
            
            // –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–¥–∫–æ—Å—Ç–µ–π
            const rarityOrder = ['Contraband', 'Covert', 'Classified', 'Restricted', 'Mil-Spec', 'Industrial Grade', 'Consumer Grade'];
            
            let html = '';
            rarityOrder.forEach(rarity => {
                if (skinsByRarity[rarity]) {
                    html += `<div class="modal-rarity-section">
                        <div class="modal-rarity-title" style="color: ${skinsByRarity[rarity][0]?.rarity?.color || '#fff'}">${rarity} (${skinsByRarity[rarity].length})</div>
                        <div class="modal-skins-row">`;
                    
                    skinsByRarity[rarity].forEach(skin => {
                        const wearBadge = skin.wear ? `<div class="wear-badge ${skin.wear}">${skin.wear.toUpperCase()}</div>` : '';
                        html += `
                            <div class="modal-skin-item" style="border-color: ${skin.rarity?.color || '#b0c3d9'}; position: relative;">
                                ${wearBadge}
                                <img src="${skin.image}" alt="${skin.name}" loading="lazy">
                                <div class="modal-skin-name">${skin.pattern?.name || skin.name?.split('|')[1]?.trim() || skin.name}</div>
                            </div>`;
                    });
                    
                    html += `</div></div>`;
                }
            });
            
            modalGrid.innerHTML = html;
            modal.classList.add('active');
        }
        
        function closeCaseModal() {
            document.getElementById('case-modal').classList.remove('active');
        }

        // ===== –û–¢–†–ò–°–û–í–ö–ê –õ–ò–î–ï–†–ë–û–†–î–ê =====
        function renderLeaderboard() {
            const container = document.getElementById('leaderboard');
            container.innerHTML = '';
            
            fakeLeaderboard.forEach((player, index) => {
                const rankClass = index === 0 ? 'gold' : index === 1 ? 'silver' : index === 2 ? 'bronze' : 'default';
                
                const item = document.createElement('div');
                item.className = 'leaderboard-item';
                item.innerHTML = `
                    <div class="leaderboard-rank ${rankClass}">${index + 1}</div>
                    <div class="leaderboard-info">
                        <div class="leaderboard-name">${player.name}</div>
                        <div class="leaderboard-stats">üì¶ ${player.cases} –∫–µ–π—Å–æ–≤ ‚Ä¢ ‚è±Ô∏è ${player.hours}—á ‚Ä¢ K/D: ${player.kd}</div>
                    </div>
                    <div class="leaderboard-value">${(player.cases * 100).toLocaleString()} ‚≠ê</div>
                `;
                container.appendChild(item);
            });
        }

        // ===== –û–¢–ö–†–´–¢–ò–ï –ö–ï–ô–°–ê =====
        let isSpinning = false; // –§–ª–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏
        
        async function openCase(caseId) {
            if (isSpinning) {
                return; // –£–∂–µ –∫—Ä—É—Ç–∏—Ç—Å—è
            }
            
            if (!app.canOpenCase(caseId)) {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞!');
                return;
            }
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∫–µ–π—Å—ã
            isSpinning = true;
            document.querySelectorAll('.case-card').forEach(card => {
                card.classList.add('spinning');
            });

            const carouselContainer = document.getElementById('carousel-container');
            carouselContainer.classList.add('active');
            carouselContainer.innerHTML = '<div style="text-align:center;padding:20px;">üé∞ –ö—Ä—É—Ç–∏–º...</div>';

            try {
                const result = await app.openCaseAnimated(caseId, carouselContainer);
                
                setTimeout(() => {
                    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–µ–π—Å—ã
                    isSpinning = false;
                    document.querySelectorAll('.case-card').forEach(card => {
                        card.classList.remove('spinning');
                    });
                    updateUI();
                }, 1000);
                
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
                carouselContainer.classList.remove('active');
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–∏ –æ—à–∏–±–∫–µ
                isSpinning = false;
                document.querySelectorAll('.case-card').forEach(card => {
                    card.classList.remove('spinning');
                });
            }
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï UI =====
        function updateUI() {
            const playerData = app.getPlayerData();
            
            // –ë–∞–ª–∞–Ω—Å
            document.getElementById('balance').textContent = playerData.balance.toLocaleString();
            document.getElementById('profile-balance').textContent = playerData.balance.toLocaleString();
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('profile-cases-opened').textContent = playerData.stats.casesOpened;
            document.getElementById('profile-inventory-count').textContent = playerData.inventory.length;
            document.getElementById('inv-count').textContent = playerData.inventory.length;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–µ–π—Å–æ–≤
            const cases = app.getCases();
            const cards = document.querySelectorAll('.case-card');
            
            cards.forEach((card, index) => {
                if (cases[index] && playerData.balance < cases[index].price) {
                    card.classList.add('disabled');
                } else {
                    card.classList.remove('disabled');
                }
            });
            
            renderInventory(playerData.inventory);
        }

        // ===== –í–´–ë–†–ê–ù–ù–´–ï –°–ö–ò–ù–´ =====
        let selectedItemIds = new Set();
        
        // ===== –ü–ê–ì–ò–ù–ê–¶–ò–Ø –ò–ù–í–ï–ù–¢–ê–†–Ø =====
        const ITEMS_PER_PAGE = 30;
        let currentInventoryPage = 1;
        let totalInventoryPages = 1;
        let currentInventoryData = [];
        
        function prevInventoryPage() {
            if (currentInventoryPage > 1) {
                currentInventoryPage--;
                renderInventoryPage();
            }
        }
        
        function nextInventoryPage() {
            if (currentInventoryPage < totalInventoryPages) {
                currentInventoryPage++;
                renderInventoryPage();
            }
        }
        
        function renderInventoryPage() {
            const grid = document.getElementById('inventory-grid');
            if (!grid) return;
            grid.innerHTML = '';
            
            // –í—ã—á–∏—Å–ª—è–µ–º –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            const reversed = [...currentInventoryData].reverse();
            const startIdx = (currentInventoryPage - 1) * ITEMS_PER_PAGE;
            const endIdx = startIdx + ITEMS_PER_PAGE;
            const pageItems = reversed.slice(startIdx, endIdx);
            
            pageItems.forEach((item) => {
                const el = document.createElement('div');
                el.className = 'inv-item';
                el.dataset.uid = item._uid;
                el.style.position = 'relative';
                
                const color = item.rarity?.color || '#b0c3d9';
                el.style.borderLeft = `3px solid ${color}`;
                
                const price = getSkinPrice(item);
                const itemName = item.pattern?.name || item.name?.split('|')[1]?.trim() || item.name || '–°–∫–∏–Ω';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–±—Ä–∞–Ω –ª–∏
                if (selectedItemIds.has(item._uid)) {
                    el.classList.add('selected');
                }
                
                el.innerHTML = `
                    <input type="checkbox" class="inv-item-checkbox" data-uid="${item._uid}" 
                           ${selectedItemIds.has(item._uid) ? 'checked' : ''}
                           onclick="event.stopPropagation(); toggleItemById('${item._uid}')">
                    ${item.wear ? `<div class="wear-badge ${item.wear}">${item.wear.toUpperCase()}</div>` : ''}
                    <img src="${item.image}" alt="${itemName}" onerror="this.src='https://via.placeholder.com/70?text=?'">
                    <div class="inv-item-name">${itemName}</div>
                    <div class="inv-item-price">${formatPriceDisplay(item)}</div>
                    <div class="inv-item-buttons">
                        <button class="inv-btn inv-btn-sell" data-uid="${item._uid}" onclick="event.stopPropagation(); sellItemById('${item._uid}')">üí∞</button>
                        <button class="inv-btn inv-btn-withdraw" data-uid="${item._uid}" onclick="event.stopPropagation(); withdrawItemById('${item._uid}')">üì§</button>
                    </div>
                    <div class="inv-item-progress"><div class="inv-item-progress-bar"></div></div>
                `;
                
                el.onclick = () => toggleItemById(item._uid);
                grid.appendChild(el);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
            const pagination = document.getElementById('inventory-pagination');
            const currentPageEl = document.getElementById('inv-current-page');
            const totalPagesEl = document.getElementById('inv-total-pages');
            const prevBtn = pagination?.querySelector('.pagination-btn:first-child');
            const nextBtn = pagination?.querySelector('.pagination-btn:last-child');
            
            if (pagination) {
                pagination.style.display = totalInventoryPages > 1 ? 'flex' : 'none';
            }
            if (currentPageEl) currentPageEl.textContent = currentInventoryPage;
            if (totalPagesEl) totalPagesEl.textContent = totalInventoryPages;
            if (prevBtn) prevBtn.disabled = currentInventoryPage <= 1;
            if (nextBtn) nextBtn.disabled = currentInventoryPage >= totalInventoryPages;
        }
        
        // ===== –û–¢–†–ò–°–û–í–ö–ê –ò–ù–í–ï–ù–¢–ê–†–Ø =====
        function renderInventory(inventory) {
            const grid = document.getElementById('inventory-grid');
            if (!grid) return;
            
            // –ù–ï –æ—á–∏—â–∞–µ–º –≤—ã–±–æ—Ä –ø—Ä–∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–µ
            // selectedItemIds.clear();
            updateSelectionUI();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —á–µ–∫–±–æ–∫—Å "–≤—ã–±—Ä–∞—Ç—å –≤—Å—ë"
            const selectAllCheckbox = document.getElementById('select-all-checkbox');
            if (selectAllCheckbox) selectAllCheckbox.checked = false;
            
            if (!inventory || inventory.length === 0) {
                grid.innerHTML = '<div style="opacity:0.5;grid-column:1/-1;text-align:center;padding:20px;">–ü—É—Å—Ç–æ ‚Äî –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–µ–π—Å!</div>';
                document.getElementById('inventory-pagination').style.display = 'none';
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            inventory.forEach((item, idx) => {
                if (!item._uid) {
                    item._uid = `item_${Date.now()}_${idx}_${Math.random().toString(36).substr(2, 9)}`;
                }
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
            currentInventoryData = inventory;
            totalInventoryPages = Math.ceil(inventory.length / ITEMS_PER_PAGE);
            
            // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –µ—Å–ª–∏ –≤—ã—à–ª–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã
            if (currentInventoryPage > totalInventoryPages) {
                currentInventoryPage = Math.max(1, totalInventoryPages);
            }
            
            renderInventoryPage();
        }
        
        // –ù–∞–π—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç –ø–æ UID
        function findItemByUid(uid) {
            return app.player.inventory.find(item => item._uid === uid);
        }
        
        // –ù–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å –ø—Ä–µ–¥–º–µ—Ç–∞ –ø–æ UID
        function findItemIndexByUid(uid) {
            return app.player.inventory.findIndex(item => item._uid === uid);
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞ –ø–æ UID
        function toggleItemById(uid) {
            const itemEl = document.querySelector(`[data-uid="${uid}"]`);
            const checkbox = document.querySelector(`.inv-item-checkbox[data-uid="${uid}"]`);
            
            if (selectedItemIds.has(uid)) {
                selectedItemIds.delete(uid);
                if (itemEl) itemEl.classList.remove('selected');
                if (checkbox) checkbox.checked = false;
            } else {
                selectedItemIds.add(uid);
                if (itemEl) itemEl.classList.add('selected');
                if (checkbox) checkbox.checked = true;
            }
            updateSelectionUI();
        }
        
        // –í—ã–±—Ä–∞—Ç—å/—Å–Ω—è—Ç—å –≤—Å—ë
        function toggleSelectAll() {
            const checkbox = document.getElementById('select-all-checkbox');
            const allCheckboxes = document.querySelectorAll('.inv-item-checkbox');
            const allItems = document.querySelectorAll('.inv-item');
            
            if (checkbox && checkbox.checked) {
                // –í—ã–±—Ä–∞—Ç—å –≤—Å–µ –≤–∏–¥–∏–º—ã–µ
                allCheckboxes.forEach(cb => {
                    const uid = cb.dataset.uid;
                    selectedItemIds.add(uid);
                    cb.checked = true;
                });
                allItems.forEach(el => el.classList.add('selected'));
            } else {
                // –°–Ω—è—Ç—å –≤—Å—ë
                selectedItemIds.clear();
                allCheckboxes.forEach(cb => cb.checked = false);
                allItems.forEach(el => el.classList.remove('selected'));
            }
            updateSelectionUI();
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å UI –≤—ã–±–æ—Ä–∞
        function updateSelectionUI() {
            const count = selectedItemIds.size;
            const sellBtn = document.getElementById('sell-all-btn');
            const withdrawBtn = document.getElementById('withdraw-btn');
            const countEl = document.getElementById('selected-count');
            
            if (sellBtn) {
                sellBtn.textContent = count > 0 ? `üí∞ –ü—Ä–æ–¥–∞—Ç—å (${count})` : 'üí∞ –ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë';
            }
            if (withdrawBtn) {
                withdrawBtn.textContent = count > 0 ? `üì§ –í—ã–≤–µ—Å—Ç–∏ (${count})` : 'üì§ –í—ã–≤–µ—Å—Ç–∏ –≤—Å—ë';
            }
            if (countEl) {
                countEl.textContent = count > 0 ? `–≤—ã–±—Ä–∞–Ω–æ: ${count}` : '';
            }
        }
        
        // –¶–µ–Ω—ã —Å–æ Steam Market
        let steamPrices = {};
        let pricesLoaded = false;
        
        // –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Ü–µ–Ω—ã –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏ (–≤ —Ä—É–±–ª—è—Ö) - —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã Steam Market
        const STEAM_PRICE_RANGES = {
            'Consumer Grade': { min: 3, max: 15 },
            'Industrial Grade': { min: 5, max: 30 },
            'Mil-Spec Grade': { min: 10, max: 200 },
            'Restricted': { min: 50, max: 1000 },
            'Classified': { min: 200, max: 5000 },
            'Covert': { min: 1000, max: 20000 },
            'Extraordinary': { min: 10000, max: 200000 },
            'Contraband': { min: 50000, max: 500000 }
        };
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω –∏–∑ prices.json –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–Ω—ã—Ö
        async function loadSteamPrices() {
            // –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –∫—ç—à –∏–∑ localStorage
            try {
                const cached = localStorage.getItem('generatedPricesCache');
                if (cached) {
                    Object.assign(generatedPricesCache, JSON.parse(cached));
                }
            } catch (e) {}
            
            try {
                const response = await fetch('prices.json');
                if (response.ok) {
                    const data = await response.json();
                    if (data.prices && Object.keys(data.prices).length > 0) {
                        steamPrices = data.prices;
                        pricesLoaded = true;
                        console.log(`üí∞ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${Object.keys(steamPrices).length} —Ü–µ–Ω —Å–æ Steam Market`);
                        return;
                    }
                }
            } catch (e) {
                // –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
            }
            
            console.log('üí∞ –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ —Ü–µ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–¥–∫–æ—Å—Ç–∏');
            pricesLoaded = true; // –ü–æ–º–µ—á–∞–µ–º —á—Ç–æ —Ü–µ–Ω—ã –¥–æ—Å—Ç—É–ø–Ω—ã (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ)
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π —Ü–µ–Ω—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–ª—è —Ä–µ–¥–∫–æ—Å—Ç–∏
        function generateSteamPrice(rarity) {
            const range = STEAM_PRICE_RANGES[rarity];
            if (!range) return null;
            
            // –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–±–æ–ª—å—à–µ –¥–µ—à—ë–≤—ã—Ö, –º–µ–Ω—å—à–µ –¥–æ—Ä–æ–≥–∏—Ö)
            const logMin = Math.log(range.min);
            const logMax = Math.log(range.max);
            const random = Math.random();
            const price = Math.exp(logMin + random * (logMax - logMin));
            
            // –û–∫—Ä—É–≥–ª—è–µ–º –∫—Ä–∞—Å–∏–≤–æ
            if (price < 10) return Math.round(price * 100) / 100;
            if (price < 100) return Math.round(price * 10) / 10;
            if (price < 1000) return Math.round(price);
            return Math.round(price / 10) * 10;
        }
        
        // –ö—ç—à —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ü–µ–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage)
        let generatedPricesCache = {};
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—ç—à–∞ —Ü–µ–Ω
        function saveGeneratedPricesCache() {
            try {
                localStorage.setItem('generatedPricesCache', JSON.stringify(generatedPricesCache));
            } catch (e) {}
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É —Å–∫–∏–Ω–∞ (–≤ –æ—á–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
        function getSkinPrice(item) {
            // –¶–µ–Ω—ã –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏ (–≤ –æ—á–∫–∞—Ö)
            const rarityPrices = { 
                'Consumer Grade': 10, 
                'Industrial Grade': 25, 
                'Mil-Spec Grade': 50,
                'Restricted': 150,
                'Classified': 500,
                'Covert': 2000,
                'Extraordinary': 5000,
                'Contraband': 10000
            };
            return rarityPrices[item.rarity?.name] || 15;
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É —Å–∫–∏–Ω–∞ —Å–æ Steam Market (–∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é)
        function getSteamPrice(item) {
            // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã
            if (steamPrices[item.id] && steamPrices[item.id].lowestPriceRaw) {
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é —Ü–µ–Ω—É –≤ —Ç–µ–∫—É—â—É—é –≤–∞–ª—é—Ç—É
                const rawPrice = steamPrices[item.id].lowestPriceRaw;
                const numPrice = parseFloat(rawPrice.replace(/[^\d.,]/g, '').replace(',', '.'));
                if (!isNaN(numPrice)) {
                    const currency = getCurrentCurrency();
                    return formatCurrencyPrice(numPrice, currency);
                }
                return rawPrice;
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–µ–Ω—É –µ—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
            if (!pricesLoaded) return null;
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
            const cacheKey = item.id || item.name;
            if (!generatedPricesCache[cacheKey]) {
                const price = generateSteamPrice(item.rarity?.name);
                if (price !== null) {
                    generatedPricesCache[cacheKey] = price; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —á–∏—Å–ª–æ!
                    saveGeneratedPricesCache();
                }
            }
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤ —Ç–µ–∫—É—â–µ–π –≤–∞–ª—é—Ç–µ
            const cachedPrice = generatedPricesCache[cacheKey];
            if (cachedPrice !== undefined && cachedPrice !== null) {
                const currency = getCurrentCurrency();
                return formatCurrencyPrice(cachedPrice, currency);
            }
            return null;
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–∞–ª—é—Ç—É
        function getCurrentCurrency() {
            return localStorage.getItem('cs2_currency') || 'RUB';
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã –≤ –≤–∞–ª—é—Ç–µ
        function formatCurrencyPrice(price, currency) {
            const symbols = { 'RUB': '‚ÇΩ', 'USD': '$', 'UAH': '‚Ç¥' };
            const symbol = symbols[currency] || '‚ÇΩ';
            
            if (currency === 'USD') {
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏–∑ —Ä—É–±–ª–µ–π –≤ –¥–æ–ª–ª–∞—Ä—ã (–ø—Ä–∏–º–µ—Ä–Ω—ã–π –∫—É—Ä—Å)
                price = price / 90;
            } else if (currency === 'UAH') {
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏–∑ —Ä—É–±–ª–µ–π –≤ –≥—Ä–∏–≤–Ω—ã (–ø—Ä–∏–º–µ—Ä–Ω—ã–π –∫—É—Ä—Å)
                price = price / 2.2;
            }
            
            if (price < 1) {
                return `${price.toFixed(2)} ${symbol}`;
            } else if (price < 100) {
                return `${price.toFixed(1)} ${symbol}`;
            } else if (price < 1000) {
                return `${Math.round(price)} ${symbol}`;
            }
            return `${price.toLocaleString('ru-RU', {maximumFractionDigits: 0})} ${symbol}`;
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function formatPriceDisplay(item) {
            const appPrice = getSkinPrice(item);
            const steamPrice = getSteamPrice(item);
            
            if (steamPrice) {
                return `${appPrice} ‚≠ê <span style="color: #8899a6; font-size: 8px;">(~${steamPrice})</span>`;
            }
            return `${appPrice} ‚≠ê`;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π –∑–∞–≥—Ä—É–∑–∫–∏
        function showLoadingOverlay(text = '–û–±—Ä–∞–±–æ—Ç–∫–∞...', subtext = '') {
            let overlay = document.getElementById('loading-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = 'loading-overlay';
                overlay.className = 'loading-overlay';
                overlay.innerHTML = `
                    <div class="loading-spinner"></div>
                    <div class="loading-text"></div>
                    <div class="loading-subtext"></div>
                    <div class="loading-progress"><div class="loading-progress-bar" style="width: 0%"></div></div>
                `;
                document.body.appendChild(overlay);
            }
            overlay.querySelector('.loading-text').textContent = text;
            overlay.querySelector('.loading-subtext').textContent = subtext;
            overlay.querySelector('.loading-progress-bar').style.width = '0%';
            overlay.classList.add('active');
            return overlay;
        }
        
        // –°–∫—Ä—ã—Ç—å –æ–≤–µ—Ä–ª–µ–π –∑–∞–≥—Ä—É–∑–∫–∏
        function hideLoadingOverlay() {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) overlay.classList.remove('active');
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö –ø—Ä–æ–¥–∞–∂–∏
        function showSellSuccess(count, total) {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) {
                overlay.innerHTML = `
                    <div class="sell-success-icon">‚úÖ</div>
                    <div class="loading-text">–ü—Ä–æ–¥–∞–Ω–æ!</div>
                    <div class="loading-subtext">${count} –ø—Ä–µ–¥–º–µ—Ç(–æ–≤) –∑–∞ ${total.toLocaleString()} ‚≠ê</div>
                `;
                setTimeout(() => {
                    hideLoadingOverlay();
                    overlay.innerHTML = `
                        <div class="loading-spinner"></div>
                        <div class="loading-text"></div>
                        <div class="loading-subtext"></div>
                        <div class="loading-progress"><div class="loading-progress-bar" style="width: 0%"></div></div>
                    `;
                }, 1500);
            }
        }
        
        // –ü—Ä–æ–¥–∞—Ç—å –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –ø–æ UID
        function sellItemById(uid) {
            const settings = getShopSettings();
            if (!settings.sellEnabled) {
                alert('‚ùå –ü—Ä–æ–¥–∞–∂–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
                return;
            }
            
            const index = findItemIndexByUid(uid);
            if (index === -1) return;
            
            const itemEl = document.querySelector(`.inv-item[data-uid="${uid}"]`);
            if (!itemEl || itemEl.classList.contains('selling')) return;
            
            const item = app.player.inventory[index];
            const price = getSkinPrice(item);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏
            itemEl.classList.add('selling');
            
            // –ß–µ—Ä–µ–∑ 600–º—Å –∑–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–¥–∞–∂—É
            setTimeout(() => {
                // –£–¥–∞–ª—è–µ–º –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                app.player.inventory.splice(index, 1);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ app
                app.addBalance(price);
                
                // –£–±–∏—Ä–∞–µ–º –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
                selectedItemIds.delete(uid);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
                itemEl.classList.add('sold');
                
                setTimeout(() => {
                    // –û–±–Ω–æ–≤–ª—è–µ–º UI
                    updateUI();
                }, 300);
            }, 600);
        }
        
        // –í—ã–≤–µ—Å—Ç–∏ –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –ø–æ UID
        function withdrawItemById(uid) {
            const settings = getShopSettings();
            if (!settings.withdrawEnabled) {
                alert('‚ùå –í—ã–≤–æ–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
                return;
            }
            
            if (!steamLinked) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–≤—è–∂–∏—Ç–µ Steam –∞–∫–∫–∞—É–Ω—Ç –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö!');
                return;
            }
            
            const index = findItemIndexByUid(uid);
            if (index === -1) return;
            
            const item = app.player.inventory[index];
            const itemName = item.pattern?.name || item.name?.split('|')[1]?.trim() || item.name;
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            app.player.inventory.splice(index, 1);
            app.player.save();
            
            // –£–±–∏—Ä–∞–µ–º –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
            selectedItemIds.delete(uid);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            
            alert(`‚úÖ "${itemName}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤—ã–≤–æ–¥!`);
        }

        // ===== –ü–†–û–î–ê–¢–¨ (–í–´–ë–†–ê–ù–ù–´–ï –ò–õ–ò –í–°–ï) =====
        function sellItems() {
            const settings = getShopSettings();
            if (!settings.sellEnabled) {
                alert('‚ùå –ü—Ä–æ–¥–∞–∂–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
                return;
            }
            
            if (app.player.inventory.length === 0) {
                alert('üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç!');
                return;
            }
            
            let itemsToSell = [];
            
            if (selectedItemIds.size > 0) {
                // –°–æ–±–∏—Ä–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                selectedItemIds.forEach(uid => {
                    const item = findItemByUid(uid);
                    if (item) itemsToSell.push(item);
                });
            } else {
                // –ü—Ä–æ–¥–∞—ë–º –≤—Å—ë
                if (!confirm(`–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ ${app.player.inventory.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤?`)) return;
                itemsToSell = [...app.player.inventory];
            }
            
            if (itemsToSell.length === 0) return;
            
            // –°—á–∏—Ç–∞–µ–º —Å—É–º–º—É
            let totalValue = itemsToSell.reduce((sum, item) => sum + getSkinPrice(item), 0);
            const itemCount = itemsToSell.length;
            
            // –ê–Ω–∏–º–∏—Ä—É–µ–º –∫–∞–∂–¥—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            const uidsToSell = itemsToSell.map(i => i._uid);
            
            uidsToSell.forEach((uid, i) => {
                const itemEl = document.querySelector(`.inv-item[data-uid="${uid}"]`);
                if (itemEl) {
                    setTimeout(() => {
                        itemEl.classList.add('selling');
                    }, i * 50); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
                }
            });
            
            // –ß–µ—Ä–µ–∑ 700–º—Å –∑–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–¥–∞–∂—É
            setTimeout(() => {
                // –£–¥–∞–ª—è–µ–º –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                const uidsToRemove = new Set(uidsToSell);
                app.player.inventory = app.player.inventory.filter(item => !uidsToRemove.has(item._uid));
                
                // –î–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ app
                app.addBalance(totalValue);
                selectedItemIds.clear();
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
                uidsToSell.forEach(uid => {
                    const itemEl = document.querySelector(`.inv-item[data-uid="${uid}"]`);
                    if (itemEl) itemEl.classList.add('sold');
                });
                
                setTimeout(() => {
                    updateUI();
                    alert(`üí∞ –ü—Ä–æ–¥–∞–Ω–æ ${itemCount} —à—Ç. –∑–∞ ${totalValue.toLocaleString()} ‚≠ê`);
                }, 300);
            }, 600 + uidsToSell.length * 50);
        }
        
        // ===== –í–´–í–û–î –ù–ê STEAM (–í–´–ë–†–ê–ù–ù–´–ï –ò–õ–ò –í–°–ï) =====
        function withdrawItems() {
            const settings = getShopSettings();
            if (!settings.withdrawEnabled) {
                alert('‚ùå –í—ã–≤–æ–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
                return;
            }
            
            if (!steamLinked) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–≤—è–∂–∏—Ç–µ Steam –∞–∫–∫–∞—É–Ω—Ç –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö!');
                return;
            }
            
            if (app.player.inventory.length === 0) {
                alert('üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç!');
                return;
            }
            
            let itemsToWithdraw = [];
            
            if (selectedItemIds.size > 0) {
                // –°–æ–±–∏—Ä–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                selectedItemIds.forEach(uid => {
                    const item = findItemByUid(uid);
                    if (item) itemsToWithdraw.push(item);
                });
            } else {
                // –í—ã–≤–æ–¥–∏–º –≤—Å—ë
                if (!confirm(`–í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ ${app.player.inventory.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –Ω–∞ Steam?`)) return;
                itemsToWithdraw = [...app.player.inventory];
            }
            
            if (itemsToWithdraw.length === 0) return;
            
            const itemCount = itemsToWithdraw.length;
            
            // –£–¥–∞–ª—è–µ–º –≤—ã–≤–µ–¥–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
            const uidsToRemove = new Set(itemsToWithdraw.map(i => i._uid));
            app.player.inventory = app.player.inventory.filter(item => !uidsToRemove.has(item._uid));
            
            app.player.save();
            selectedItemIds.clear();
            
            updateUI();
            
            alert(`‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ ${itemCount} –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!\n\nüìß –ü—Ä–µ–¥–º–µ—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –≤–∞—à–µ–º Steam –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.`);
        }
        
        // ===== –ù–ê–°–¢–†–û–ô–ö–ò –ú–ê–ì–ê–ó–ò–ù–ê =====
        function getShopSettings() {
            const saved = localStorage.getItem('shopSettings');
            if (saved) return JSON.parse(saved);
            return { sellEnabled: true, withdrawEnabled: true };
        }
        
        function saveShopSettings(settings) {
            localStorage.setItem('shopSettings', JSON.stringify(settings));
        }
        
        function updateShopButtons() {
            const settings = getShopSettings();
            const sellBtn = document.getElementById('sell-all-btn');
            const withdrawBtn = document.getElementById('withdraw-btn');
            
            if (sellBtn) {
                sellBtn.style.opacity = settings.sellEnabled ? '1' : '0.5';
                sellBtn.style.pointerEvents = settings.sellEnabled ? 'auto' : 'auto';
            }
            if (withdrawBtn) {
                withdrawBtn.style.opacity = settings.withdrawEnabled ? '1' : '0.5';
                withdrawBtn.style.pointerEvents = settings.withdrawEnabled ? 'auto' : 'auto';
            }
        }

        // ===== STEAM –ü–†–ò–í–Ø–ó–ö–ê (–§–ï–ô–ö) =====
        function updateSteamStatus() {
            const statusEl = document.getElementById('steam-status');
            const btnEl = document.getElementById('steam-btn');
            const infoEl = document.getElementById('steam-info');
            
            if (steamLinked) {
                statusEl.textContent = '–ü—Ä–∏–≤—è–∑–∞–Ω';
                statusEl.style.color = '#00b894';
                btnEl.textContent = '‚úì –ü—Ä–∏–≤—è–∑–∞–Ω';
                btnEl.disabled = true;
                btnEl.style.opacity = '0.7';
                infoEl.style.display = 'block';
            } else {
                statusEl.textContent = '–ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω';
                statusEl.style.color = '#ff6b6b';
                btnEl.textContent = 'üéÆ –ü—Ä–∏–≤—è–∑–∞—Ç—å';
                btnEl.disabled = false;
                btnEl.style.opacity = '1';
                infoEl.style.display = 'none';
            }
        }
        
        function linkSteam() {
            if (confirm('–ü—Ä–∏–≤—è–∑–∞—Ç—å Steam –∞–∫–∫–∞—É–Ω—Ç?\n\n(–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Steam)')) {
                steamLinked = true;
                localStorage.setItem('steamLinked', 'true');
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ñ–µ–π–∫–æ–≤—ã–π Steam ID
                const fakeId = '7656119' + Math.floor(Math.random() * 9000000000 + 1000000000);
                document.getElementById('steam-id').textContent = fakeId;
                
                updateSteamStatus();
                alert('‚úÖ Steam –∞–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω!');
            }
        }
        
        function toggleNotifications() {
            alert('üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω—ã!');
        }
        
        function toggleSound() {
            alert('üîä –ó–≤—É–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω—ã!');
        }

        // ===== –î–û–ë–ê–í–ò–¢–¨ –ë–ê–õ–ê–ù–° =====
        function addBalance() {
            app.addBalance(1000);
            updateUI();
        }

        // ===== –°–ë–†–û–° –î–ê–ù–ù–´–• =====
        function resetData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!')) {
                localStorage.clear();
                location.reload();
            }
        }

        // ========================================
        // ===== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ =====
        // ========================================
        
        let allSkins = []; // –í—Å–µ —Å–∫–∏–Ω—ã –∏–∑ skins.json
        let selectedSkins = []; // –í—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–ª—è –∫–µ–π—Å–∞ —Å–∫–∏–Ω—ã
        let customCases = JSON.parse(localStorage.getItem('customCases') || '[]');
        let deletedStandardCases = JSON.parse(localStorage.getItem('deletedStandardCases') || '[]');
        let modifiedStandardCases = JSON.parse(localStorage.getItem('modifiedStandardCases') || '{}');
        let isAdminLoggedIn = sessionStorage.getItem('adminLoggedIn') === 'true';
        
        // ===== –ù–ê–°–¢–†–û–ô–ö–ò –ê–î–ú–ò–ù–ê =====
        // –ò–ó–ú–ï–ù–ò–¢–ï –ü–ê–†–û–õ–¨ –ó–î–ï–°–¨! (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: admin123)
        const ADMIN_PASSWORD = 'admin123';
        
        // –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram ID (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π ID):
        // const ADMIN_TELEGRAM_IDS = [123456789, 987654321];
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –∞–¥–º–∏–Ω–∞
        function checkAdminPassword() {
            const input = document.getElementById('admin-password').value;
            
            if (input === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                sessionStorage.setItem('adminLoggedIn', 'true');
                updateAdminUI();
                alert('‚úÖ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!');
            } else {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!');
            }
            
            document.getElementById('admin-password').value = '';
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω–∫–∏
        function logoutAdmin() {
            isAdminLoggedIn = false;
            sessionStorage.removeItem('adminLoggedIn');
            updateAdminUI();
            closeAdminPanel();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –∞–¥–º–∏–Ω–∫–∏
        function updateAdminUI() {
            const loginForm = document.getElementById('admin-login-form');
            const loggedIn = document.getElementById('admin-logged-in');
            
            if (isAdminLoggedIn) {
                loginForm.style.display = 'none';
                loggedIn.style.display = 'block';
            } else {
                loginForm.style.display = 'block';
                loggedIn.style.display = 'none';
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Telegram ID (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
        function checkTelegramAdmin() {
            if (typeof ADMIN_TELEGRAM_IDS === 'undefined') return false;
            
            const tg = window.Telegram?.WebApp;
            if (!tg || !tg.initDataUnsafe?.user?.id) return false;
            
            const userId = tg.initDataUnsafe.user.id;
            return ADMIN_TELEGRAM_IDS.includes(userId);
        }
        
        function openAdminPanel() {
            if (!isAdminLoggedIn) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!');
                return;
            }
            document.getElementById('admin-panel').classList.add('active');
            loadAllSkins();
            renderAdminCaseList();
        }
        
        function closeAdminPanel() {
            document.getElementById('admin-panel').classList.remove('active');
        }
        
        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('admin-cases-tab').style.display = tab === 'cases' ? 'block' : 'none';
            document.getElementById('admin-create-tab').style.display = tab === 'create' ? 'block' : 'none';
            document.getElementById('admin-quests-tab').style.display = tab === 'quests' ? 'block' : 'none';
            document.getElementById('admin-settings-tab').style.display = tab === 'settings' ? 'block' : 'none';
            
            if (tab === 'create') {
                // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ —Å–∫–∏–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
                loadAllSkins().then(() => {
                    filterAdminSkins();
                });
            }
            
            if (tab === 'quests') {
                initQuestEditor();
            }
            
            if (tab === 'settings') {
                loadAdminShopSettings();
            }
        }
        
        // ===== –†–ï–î–ê–ö–¢–û–† –ö–í–ï–°–¢–û–í =====
        function initQuestEditor() {
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ –∫–≤–µ—Å—Ç–æ–≤
            const select = document.getElementById('quest-type-select');
            select.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–≤–µ—Å—Ç–∞ --</option>' +
                QUEST_TYPES_POOL.map(q => `
                    <option value="${q.id}" data-icon="${q.icon}" data-unit="${q.unit}">
                        ${q.icon} ${q.label}
                    </option>
                `).join('');
            
            renderQuestPool();
        }
        
        function renderQuestPool() {
            const templates = getQuestTemplates();
            const container = document.getElementById('quest-pool-list');
            document.getElementById('quest-pool-count').textContent = templates.length;
            
            if (templates.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #8899a6; padding: 20px;">–ù–µ—Ç –∫–≤–µ—Å—Ç–æ–≤. –î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω!</div>';
                return;
            }
            
            container.innerHTML = templates.map((quest, index) => `
                <div style="display: flex; align-items: center; gap: 10px; padding: 12px; background: #243447; border-radius: 8px;">
                    <span style="font-size: 20px;">${quest.icon}</span>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 13px;">${quest.title}</div>
                        <div style="font-size: 11px; color: #8899a6;">${quest.description}</div>
                    </div>
                    <div style="text-align: center; padding: 5px 10px; background: #1c2733; border-radius: 5px;">
                        <div style="font-size: 14px; color: #f7b733; font-weight: bold;">+${quest.reward}</div>
                        <div style="font-size: 9px; color: #8899a6;">–æ—á–∫–æ–≤</div>
                    </div>
                    <button onclick="removeQuestFromPool(${index})" style="background: #e74c3c; border: none; color: white; padding: 8px 12px; border-radius: 5px; cursor: pointer;">‚úï</button>
                </div>
            `).join('');
        }
        
        function addCustomQuest() {
            const typeSelect = document.getElementById('quest-type-select');
            const targetInput = document.getElementById('quest-target-input');
            const rewardInput = document.getElementById('quest-reward-input');
            
            const typeId = typeSelect.value;
            const target = parseInt(targetInput.value) || 5;
            const reward = parseInt(rewardInput.value) || 4;
            
            if (!typeId) {
                alert('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–≤–µ—Å—Ç–∞!');
                return;
            }
            
            const questType = QUEST_TYPES_POOL.find(q => q.id === typeId);
            if (!questType) return;
            
            const newQuest = {
                id: `${typeId}_${Date.now()}`,
                title: `${questType.icon} ${questType.label}`,
                description: `${questType.label}: ${target} ${questType.unit}`,
                target: target,
                reward: reward,
                icon: questType.icon
            };
            
            const templates = getQuestTemplates();
            templates.push(newQuest);
            localStorage.setItem('cs2_quest_templates', JSON.stringify(templates));
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            typeSelect.value = '';
            targetInput.value = '5';
            rewardInput.value = '4';
            
            renderQuestPool();
            alert('‚úÖ –ö–≤–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω!');
        }
        
        function removeQuestFromPool(index) {
            const templates = getQuestTemplates();
            if (templates.length <= 4) {
                alert('‚ùå –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 4 –∫–≤–µ—Å—Ç–∞ –≤ –ø—É–ª–µ!');
                return;
            }
            templates.splice(index, 1);
            localStorage.setItem('cs2_quest_templates', JSON.stringify(templates));
            renderQuestPool();
        }
        
        function resetQuestsToDefault() {
            if (!confirm('–í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–≤–µ—Å—Ç—ã? –í—Å–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) return;
            localStorage.removeItem('cs2_quest_templates');
            renderQuestPool();
            alert('‚úÖ –ö–≤–µ—Å—Ç—ã —Å–±—Ä–æ—à–µ–Ω—ã –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º!');
        }
        
        function forceNewDailyQuests() {
            if (!confirm('–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤?')) return;
            localStorage.removeItem('cs2_quests');
            renderQuests();
            alert('‚úÖ –ù–æ–≤—ã–µ –¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ –∞–¥–º–∏–Ω–∫–µ
        function loadAdminShopSettings() {
            const settings = getShopSettings();
            document.getElementById('admin-sell-toggle').checked = settings.sellEnabled;
            document.getElementById('admin-withdraw-toggle').checked = settings.withdrawEnabled;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
        function toggleShopSetting(setting) {
            const settings = getShopSettings();
            if (setting === 'sell') {
                settings.sellEnabled = document.getElementById('admin-sell-toggle').checked;
            } else if (setting === 'withdraw') {
                settings.withdrawEnabled = document.getElementById('admin-withdraw-toggle').checked;
            }
            saveShopSettings(settings);
            updateShopButtons();
            
            const status = settings[setting + 'Enabled'] ? '–≤–∫–ª—é—á–µ–Ω–∞' : '–æ—Ç–∫–ª—é—á–µ–Ω–∞';
            const name = setting === 'sell' ? '–ü—Ä–æ–¥–∞–∂–∞' : '–í—ã–≤–æ–¥';
            alert(`${name} ${status}`);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å–∫–∏–Ω–æ–≤
        async function loadAllSkins() {
            if (allSkins.length > 0) return;
            
            try {
                const response = await fetch('skins.json');
                allSkins = await response.json();
                console.log(`Loaded ${allSkins.length} skins for admin`);
            } catch (e) {
                console.error('Failed to load skins:', e);
            }
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–µ–π—Å–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ
        function renderAdminCaseList() {
            const container = document.getElementById('admin-case-list');
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∫–µ–π—Å—ã
            const allCases = app.getCases();
            
            container.innerHTML = allCases.map(caseData => `
                <div class="admin-case-item">
                    <div class="admin-case-info">
                        <h4>${caseData.name} ${caseData.isCustom ? '(–∫–∞—Å—Ç–æ–º–Ω—ã–π)' : '(—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π)'}</h4>
                        <p>${caseData.skins?.length || 0} —Å–∫–∏–Ω–æ–≤ ‚Ä¢ ${caseData.price} ‚≠ê</p>
                    </div>
                    <div class="admin-case-actions">
                        <button class="admin-btn admin-btn-edit" onclick="editAdminCase('${caseData.id}', ${!caseData.isCustom})">‚úèÔ∏è</button>
                        <button class="admin-btn admin-btn-delete" onclick="deleteAdminCase('${caseData.id}')">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–µ—Ç–∫–∏ —Å–∫–∏–Ω–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞
        function renderAdminSkinsGrid(filter = '') {
            const container = document.getElementById('admin-skins-grid');
            const rarityFilter = document.getElementById('admin-rarity-filter').value;
            const weaponFilter = document.getElementById('admin-weapon-filter').value;
            
            let filtered = allSkins.filter(s => s.image);
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∏—Å–∫—É
            if (filter) {
                const lowerFilter = filter.toLowerCase();
                filtered = filtered.filter(s => 
                    s.name?.toLowerCase().includes(lowerFilter) ||
                    s.weapon?.toLowerCase().includes(lowerFilter)
                );
            }
            
            // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –æ—Ä—É–∂–∏—è
            if (weaponFilter) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –ø–æ –æ—Ä—É–∂–∏—é
                if (weaponFilter.startsWith('category:')) {
                    const categoryName = weaponFilter.replace('category:', '');
                    filtered = filtered.filter(s => s.category?.name === categoryName);
                } else {
                    const weapons = weaponFilter.split(',').map(w => w.toLowerCase().trim());
                    filtered = filtered.filter(s => {
                        const skinName = (s.name || '').toLowerCase();
                        const weaponName = (s.weapon?.name || '').toLowerCase();
                        return weapons.some(w => 
                            skinName.includes(w) || 
                            weaponName.includes(w)
                        );
                    });
                }
            }
            
            // –§–∏–ª—å—Ç—Ä –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
            if (rarityFilter) {
                filtered = filtered.filter(s => 
                    s.rarity?.name === rarityFilter
                );
            }
            
            const totalCount = filtered.length;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫–∏–Ω—ã
            let html = `<div style="grid-column:1/-1;text-align:center;color:#8899a6;font-size:12px;padding:5px;">
                –ù–∞–π–¥–µ–Ω–æ: ${totalCount} —Å–∫–∏–Ω–æ–≤
            </div>`;
            
            html += filtered.map(skin => {
                const isSelected = selectedSkins.some(s => s.id === skin.id);
                return `
                    <div class="admin-skin-item ${isSelected ? 'selected' : ''}" 
                         onclick="toggleAdminSkin('${skin.id}')"
                         style="border-color: ${isSelected ? '#00b894' : skin.rarity?.color || '#b0c3d9'}">
                        <img src="${skin.image}" alt="${skin.name}" loading="lazy">
                        <div class="admin-skin-item-name">${skin.pattern?.name || skin.name?.split('|')[1]?.trim() || skin.name}</div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            
            if (filtered.length === 0) {
                container.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:#8899a6;padding:20px;">–°–∫–∏–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã.</div>';
            }
        }
        
        function filterAdminSkins() {
            const search = document.getElementById('admin-skin-search').value;
            renderAdminSkinsGrid(search);
        }
        
        // –£—Ä–æ–≤–Ω–∏ –∏–∑–Ω–æ—Å–∞
        const WEAR_LEVELS = [
            { id: 'fn', name: 'Factory New', short: 'FN' },
            { id: 'mw', name: 'Minimal Wear', short: 'MW' },
            { id: 'ft', name: 'Field-Tested', short: 'FT' },
            { id: 'ww', name: 'Well-Worn', short: 'WW' },
            { id: 'bs', name: 'Battle-Scarred', short: 'BS' }
        ];
        
        // –í—ã–±–æ—Ä/–æ—Ç–º–µ–Ω–∞ —Å–∫–∏–Ω–∞
        function toggleAdminSkin(skinId) {
            const skin = allSkins.find(s => s.id === skinId);
            if (!skin) return;
            
            const index = selectedSkins.findIndex(s => s.id === skinId);
            if (index >= 0) {
                selectedSkins.splice(index, 1);
                renderAdminSkinsGrid(document.getElementById('admin-skin-search').value);
                renderSelectedSkins();
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∫–∞—á–µ—Å—Ç–≤–∞
                showWearSelector(skin);
            }
        }
        
        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        function showWearSelector(skin) {
            const modal = document.createElement('div');
            modal.className = 'wear-selector-modal';
            modal.id = 'wear-selector-modal';
            modal.innerHTML = `
                <div class="wear-selector-content">
                    <div class="wear-selector-header">
                        <span>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ</span>
                        <button onclick="closeWearSelector()" class="modal-close">‚úï</button>
                    </div>
                    <div class="wear-selector-skin">
                        <img src="${skin.image}" alt="${skin.name}">
                        <div>${skin.name}</div>
                    </div>
                    <div class="wear-selector-options">
                        ${WEAR_LEVELS.map(w => `
                            <button class="wear-option" onclick="selectWearAndAdd('${skin.id}', '${w.id}', '${w.name}')">
                                <span class="wear-short">${w.short}</span>
                                <span class="wear-full">${w.name}</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('active'), 10);
        }
        
        function closeWearSelector() {
            const modal = document.getElementById('wear-selector-modal');
            if (modal) {
                modal.classList.remove('active');
                setTimeout(() => modal.remove(), 300);
            }
        }
        
        function selectWearAndAdd(skinId, wearId, wearName) {
            const skin = allSkins.find(s => s.id === skinId);
            if (!skin) return;
            
            // –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —Å–∫–∏–Ω–∞ —Å wear
            const uniqueId = `${skinId}_${wearId}`;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–≥–æ —Å–∫–∏–Ω–∞ —Å —ç—Ç–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º
            if (selectedSkins.some(s => s.id === uniqueId)) {
                closeWearSelector();
                alert('–≠—Ç–æ—Ç —Å–∫–∏–Ω —Å —Ç–∞–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω!');
                return;
            }
            
            selectedSkins.push({
                ...skin,
                id: uniqueId,
                originalId: skinId,
                wear: wearId,
                wearName: wearName,
                chance: getDefaultChance(skin.rarity?.name)
            });
            
            closeWearSelector();
            renderAdminSkinsGrid(document.getElementById('admin-skin-search').value);
            renderSelectedSkins();
        }
        
        function getDefaultChance(rarityName) {
            const chances = {
                'Consumer Grade': 79.92,
                'Industrial Grade': 15.98,
                'Mil-Spec Grade': 3.2,
                'Restricted': 0.64,
                'Classified': 0.128,
                'Covert': 0.026,
                'Extraordinary': 0.002,
                'Contraband': 0.002
            };
            return chances[rarityName] || 1;
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤
        function renderSelectedSkins() {
            const container = document.getElementById('admin-selected-list');
            document.getElementById('admin-selected-count').textContent = selectedSkins.length;
            
            if (selectedSkins.length === 0) {
                container.innerHTML = '<div style="color:#8899a6;text-align:center;padding:10px;">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–∏–Ω—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ</div>';
                return;
            }
            
            container.innerHTML = selectedSkins.map((skin, index) => `
                <div class="admin-selected-item" style="border-left: 3px solid ${skin.rarity?.color || '#b0c3d9'}">
                    <img src="${skin.image}" alt="${skin.name}">
                    <div class="admin-selected-item-info">
                        <div class="admin-selected-item-name">${skin.name}</div>
                        <div style="font-size:10px;color:#8899a6;">
                            ${skin.rarity?.name || 'Unknown'}
                            ${skin.wearName ? `<span style="color:#f7b733;"> ‚Ä¢ ${skin.wearName}</span>` : ''}
                        </div>
                    </div>
                    <input type="number" class="admin-chance-input" 
                           value="${skin.chance}" 
                           step="0.001" min="0.001" max="100"
                           onchange="updateSkinChance(${index}, this.value)"
                           title="–®–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è %">
                    <span style="font-size:10px;color:#8899a6;">%</span>
                    <button class="admin-remove-btn" onclick="removeSkinFromSelection(${index})">‚úï</button>
                </div>
            `).join('');
        }
        
        function updateSkinChance(index, value) {
            selectedSkins[index].chance = parseFloat(value) || 1;
        }
        
        function removeSkinFromSelection(index) {
            selectedSkins.splice(index, 1);
            renderAdminSkinsGrid(document.getElementById('admin-skin-search').value);
            renderSelectedSkins();
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–µ–π—Å–∞
        function saveAdminCase() {
            const name = document.getElementById('admin-case-name').value.trim();
            const price = parseInt(document.getElementById('admin-case-price').value) || 100;
            const desc = document.getElementById('admin-case-desc').value.trim();
            const editId = document.getElementById('admin-edit-id').value;
            const isEditingStandard = document.getElementById('admin-edit-is-standard').value === 'true';
            
            if (!name) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞!');
                return;
            }
            
            if (selectedSkins.length === 0) {
                alert('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–∫–∏–Ω!');
                return;
            }
            
            const caseData = {
                id: editId || 'custom_' + Date.now(),
                name: name,
                price: price,
                description: desc || '–ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–µ–π—Å',
                skins: selectedSkins.map(s => ({
                    id: s.id,
                    originalId: s.originalId || s.id,
                    name: s.name,
                    weapon: s.weapon,
                    rarity: s.rarity,
                    image: s.image,
                    pattern: s.pattern,
                    category: s.category,
                    chance: s.chance,
                    wear: s.wear,
                    wearName: s.wearName
                })),
                isCustom: !isEditingStandard
            };
            
            if (editId && isEditingStandard) {
                // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫–µ–π—Å–∞
                caseData.id = editId;
                caseData.isCustom = false;
                modifiedStandardCases[editId] = caseData;
                localStorage.setItem('modifiedStandardCases', JSON.stringify(modifiedStandardCases));
            } else if (editId) {
                // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∫–µ–π—Å–∞
                const index = customCases.findIndex(c => c.id === editId);
                if (index >= 0) {
                    customCases[index] = caseData;
                }
                localStorage.setItem('customCases', JSON.stringify(customCases));
            } else {
                // –ù–æ–≤—ã–π –∫–µ–π—Å
                caseData.isCustom = true;
                customCases.push(caseData);
                localStorage.setItem('customCases', JSON.stringify(customCases));
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–µ–π—Å—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
            updateAppCases();
            
            alert('‚úÖ –ö–µ–π—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!');
            clearAdminForm();
            switchAdminTab('cases');
            document.querySelector('.admin-tab').click();
            renderCases();
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ)
        function editAdminCase(caseId, isStandard = false) {
            let caseData;
            
            // –ù–∞—Ö–æ–¥–∏–º –∫–µ–π—Å –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ
            caseData = app.getCases().find(c => c.id === caseId);
            
            if (!caseData) return;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('admin-edit-id').value = caseId;
            document.getElementById('admin-edit-is-standard').value = isStandard ? 'true' : 'false';
            document.getElementById('admin-form-title').textContent = '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞';
            
            document.getElementById('admin-case-name').value = caseData.name;
            document.getElementById('admin-case-price').value = caseData.price;
            document.getElementById('admin-case-desc').value = caseData.description || '';
            
            selectedSkins = caseData.skins.map(s => ({...s}));
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å–æ–∑–¥–∞–Ω–∏—è
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-tab')[1].classList.add('active');
            document.getElementById('admin-cases-tab').style.display = 'none';
            document.getElementById('admin-create-tab').style.display = 'block';
            
            renderAdminSkinsGrid();
            renderSelectedSkins();
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∫–µ–π—Å–∞
        function deleteAdminCase(caseId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–µ–π—Å?')) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞—Å—Ç–æ–º–Ω—ã–π –ª–∏ —ç—Ç–æ –∫–µ–π—Å
            const isCustom = customCases.some(c => c.id === caseId);
            
            if (isCustom) {
                // –£–¥–∞–ª—è–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–µ–π—Å
                customCases = customCases.filter(c => c.id !== caseId);
                localStorage.setItem('customCases', JSON.stringify(customCases));
            } else {
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫–µ–π—Å (–¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö)
                deletedStandardCases.push(caseId);
                localStorage.setItem('deletedStandardCases', JSON.stringify(deletedStandardCases));
                
                // –¢–∞–∫–∂–µ —É–¥–∞–ª—è–µ–º –∏–∑ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –±—ã–ª
                delete modifiedStandardCases[caseId];
                localStorage.setItem('modifiedStandardCases', JSON.stringify(modifiedStandardCases));
            }
            
            updateAppCases();
            renderAdminCaseList();
            renderCases();
            
            alert('‚úÖ –ö–µ–π—Å —É–¥–∞–ª—ë–Ω!');
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Å–∫–∏–Ω–æ–≤ –∏–∑ –∫–µ–π—Å–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω
        function exportCaseSkinsForPrices() {
            const cases = app.getCases();
            const skinsMap = new Map();
            
            // –°–æ–±–∏—Ä–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∫–∏–Ω—ã –∏–∑ –≤—Å–µ—Ö –∫–µ–π—Å–æ–≤
            cases.forEach(caseData => {
                if (caseData.skins) {
                    caseData.skins.forEach(skin => {
                        if (!skinsMap.has(skin.id)) {
                            // –§–æ—Ä–º–∏—Ä—É–µ–º market_hash_name
                            const marketHashName = getMarketHashName(skin);
                            skinsMap.set(skin.id, {
                                id: skin.id,
                                name: skin.name,
                                marketHashName: marketHashName,
                                weapon: skin.weapon?.name,
                                pattern: skin.pattern?.name,
                                rarity: skin.rarity?.name,
                                category: skin.category?.name
                            });
                        }
                    });
                }
            });
            
            const exportData = {
                exportedAt: new Date().toISOString(),
                casesCount: cases.length,
                skinsCount: skinsMap.size,
                skins: Array.from(skinsMap.values())
            };
            
            // –°–æ–∑–¥–∞—ë–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'case-skins.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const statsEl = document.getElementById('export-stats');
            if (statsEl) {
                statsEl.innerHTML = `‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: <strong>${skinsMap.size}</strong> —Å–∫–∏–Ω–æ–≤ –∏–∑ <strong>${cases.length}</strong> –∫–µ–π—Å–æ–≤`;
            }
            
            alert(`‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${skinsMap.size} —Å–∫–∏–Ω–æ–≤ –∏–∑ ${cases.length} –∫–µ–π—Å–æ–≤!\n\n–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª case-skins.json –≤ –ø–∞–ø–∫—É —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:\nnode fetch-prices.js`);
        }
        
        // –ú–∞–ø–ø–∏–Ω–≥ wear ID –∫ –ø–æ–ª–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏—è–º –¥–ª—è Steam Market
        const WEAR_NAMES_MAP = {
            'fn': 'Factory New',
            'mw': 'Minimal Wear',
            'ft': 'Field-Tested',
            'ww': 'Well-Worn',
            'bs': 'Battle-Scarred'
        };
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ market_hash_name –¥–ª—è —Å–∫–∏–Ω–∞ (—Å —É—á—ë—Ç–æ–º –∏–∑–Ω–æ—Å–∞)
        function getMarketHashName(skin) {
            const weaponName = skin.weapon?.name || '';
            const patternName = skin.pattern?.name || '';
            
            let baseName;
            
            // –î–ª—è –Ω–æ–∂–µ–π
            if (skin.category?.name === 'Knives') {
                baseName = `‚òÖ ${weaponName} | ${patternName}`;
            }
            // –î–ª—è –ø–µ—Ä—á–∞—Ç–æ–∫
            else if (skin.category?.name === 'Gloves') {
                baseName = `‚òÖ ${weaponName} | ${patternName}`;
            }
            // –û–±—ã—á–Ω–æ–µ –æ—Ä—É–∂–∏–µ
            else if (weaponName && patternName) {
                baseName = `${weaponName} | ${patternName}`;
            } else {
                baseName = skin.name;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º wear –µ—Å–ª–∏ –æ–Ω —É–∫–∞–∑–∞–Ω
            if (skin.wear && WEAR_NAMES_MAP[skin.wear]) {
                return `${baseName} (${WEAR_NAMES_MAP[skin.wear]})`;
            }
            
            return baseName;
        }
        
        // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        function clearAdminForm() {
            document.getElementById('admin-edit-id').value = '';
            document.getElementById('admin-edit-is-standard').value = 'false';
            document.getElementById('admin-case-name').value = '';
            document.getElementById('admin-case-price').value = '';
            document.getElementById('admin-case-desc').value = '';
            document.getElementById('admin-form-title').textContent = '‚ûï –ù–æ–≤—ã–π –∫–µ–π—Å';
            document.getElementById('admin-skin-search').value = '';
            
            selectedSkins = [];
            renderAdminSkinsGrid();
            renderSelectedSkins();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ–π—Å–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
        function updateAppCases() {
            // –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–µ–π—Å—ã
            let standardCases = app.caseManager.originalCases || app.caseManager.cases.filter(c => !c.isCustom);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
            if (!app.caseManager.originalCases) {
                app.caseManager.originalCases = [...standardCases];
            }
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —É–¥–∞–ª—ë–Ω–Ω—ã–µ
            standardCases = app.caseManager.originalCases.filter(c => !deletedStandardCases.includes(c.id));
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –∫–µ–π—Å–∞–º
            standardCases = standardCases.map(c => {
                if (modifiedStandardCases[c.id]) {
                    return { ...modifiedStandardCases[c.id], isCustom: false };
                }
                return c;
            });
            
            // –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏
            app.caseManager.cases = [...standardCases, ...customCases];
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–µ–π—Å–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        function loadCustomCases() {
            customCases = JSON.parse(localStorage.getItem('customCases') || '[]');
            deletedStandardCases = JSON.parse(localStorage.getItem('deletedStandardCases') || '[]');
            modifiedStandardCases = JSON.parse(localStorage.getItem('modifiedStandardCases') || '{}');
            updateAppCases();
        }

        // ===== –ó–ê–ü–£–°–ö =====
        initSettings(); // Initialize theme, font, language
        initApp().then(() => {
            loadCustomCases();
            renderCases();
            updateAdminUI(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            applyTranslations(); // Apply translations after app init
        });
    </script>
</body>
</html>
